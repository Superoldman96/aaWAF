import{_ as i}from"./index.vue_vue_type_script_setup_true_lang.141d1f64.1742181728921.js";import{u as t,e,f as s,g as a}from"./index.fc641b56.1742181728921.js";import{d as o,u as r,r as n,S as p,U as d,f as l,e as c,P as _,o as m,k as u}from"./vue.314199b7.1742181728921.js";import"./DataTable.762c357a.1742181728921.js";import"./Checkbox.64335fca.1742181728921.js";import"./get-slot.a0e67e91.1742181728921.js";import"./utils.d31cac41.1742181728921.js";import"./layer.8f9c8930.1742181728921.js";const y={class:"p-16px"},h={class:"w-960px mx-auto mt-60px"},v={class:"mb-12px"},g=o({__name:"index",setup(o){const g=r({data:[]}),{loading:k,setLoading:f}=t();e("aaaaa",{time:0});const w=async()=>{try{f(!0)}finally{f(!1)}},x=new Map([["cc","CC"],["inc","多次恶意攻击"],["upload","恶意文件上传"],["scan","扫描器防御"],["sql","SQL注入拦截"],["xss","XSS注入拦截"],["file_upload","文件上传木马拦截"],["from_data","畸形文件上传协议检测"],["php_eval","PHP代码执行检测"],["ssrf","ssrf代码执行检测"],["download","恶意下载防御"],["user_agent","恶意爬虫防御"],["file_import","文件包含防御"],["file_scan","目录扫描防御"],["no_browser","非浏览器检测"],["host","Host头攻击防御"],["cookie","cookie头攻击防御"],["nday","通用漏洞检测"],["province","地区限制拦截"],["city","地区限制拦截"],["rce","命令执行拦截"]]),j=["北京","上海","天津","重庆"],W=n([{key:"time",title:"访问时间",width:"10%",minWidth:110,render:i=>a(1e3*i.time,"MM-dd HH:mm:ss")},{key:"action",title:"状态",width:"5%",minWidth:70,render:i=>1===i.action?l("span",{class:"text-desc"},[u("观察")]):l("span",{class:"text-error"},[u("已拦截")])},{key:"host",title:"域名",width:"12%",minWidth:100,ellipsis:{tooltip:{width:"trigger"}}},{key:"request_uri",title:"URI",minWidth:160,ellipsis:{tooltip:{width:"trigger"}}},{key:"ip",title:"攻击IP",width:"10%",minWidth:120,ellipsis:{tooltip:{width:"trigger"}}},{key:"ip_country",title:"IP归属地",width:"10%",minWidth:120,render:i=>"香港"===i.ip_province?"中国香港":"澳门"===i.ip_province?"中国澳门":"台湾"===i.ip_province?"中国台湾":"中国"===i.ip_country?j.includes(i.ip_province)?i.ip_province:i.ip_province||i.ip_city?"".concat(i.ip_province," - ").concat(i.ip_city):"中国":i.ip_country||"--"},{key:"risk_type",title:"攻击类型",width:"10%",minWidth:100,render:i=>x.get(i.risk_type)||i.risk_type}]);return w(),(t,e)=>{const a=s,o=i;return m(),p("div",y,[d("div",h,[d("div",v,[l(a,{onClick:w},{default:c((()=>[u("获取列表")])),_:1})]),l(o,{loading:_(k),data:_(g).data,columns:_(W)},null,8,["loading","data","columns"])])])}}});export{g as default};
