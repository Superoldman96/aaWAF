import{d as e,z as n,r as t,p as l,h as a,H as o,m as r,c as i,y as s,ar as u,w as d,A as c,x as h}from"./vue.314199b7.1742181728921.js";import{i as v,a as p,b as f,V as m,u as g,F as b,N as y,c as w,d as k}from"./utils.d31cac41.1742181728921.js";import{D as x,dm as C,d3 as R,bg as S,B as M,ca as T,dn as N,bj as F,dp as P,dq as O,bm as K,dr as A,cq as B,ds as L,ce as z,co as I,bl as j,dg as D,J as V,dt as H,K as U,cf as q,E,L as $,F as _,G as W,bk as G,ci as J,cg as Q,ck as X,cj as Y,cc as Z,I as ee,cl as ne,cm as te,cn as le,du as ae,cr as oe,cp as re,bs as ie}from"./index.fc641b56.1742181728921.js";import{c as se,_ as ue}from"./Checkbox.64335fca.1742181728921.js";const de=x("base-menu-mask","\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n display: flex;\n align-items: center;\n justify-content: center;\n text-align: center;\n padding: 14px;\n overflow: hidden;\n",[C()]),ce=e({name:"BaseMenuMask",props:{clsPrefix:{type:String,required:!0}},setup(e){R("-base-menu-mask",de,n(e,"clsPrefix"));const a=t(null);let o=null;const r=t(!1);l((()=>{null!==o&&window.clearTimeout(o)}));const i={showOnce(e,n=1500){o&&window.clearTimeout(o),r.value=!0,a.value=e,o=window.setTimeout((()=>{r.value=!1,a.value=null}),n)}};return Object.assign({message:a,show:r},i)},render(){return a(o,{name:"fade-in-transition"},{default:()=>this.show?a("div",{class:"".concat(this.clsPrefix,"-base-menu-mask")},this.message):null})}}),he=S({name:"Cascader",common:M,peers:{InternalSelectMenu:v,InternalSelection:p,Scrollbar:T,Checkbox:se,Empty:N},self:e=>{const{borderRadius:n,boxShadow2:t,popoverColor:l,textColor2:a,textColor3:o,primaryColor:r,textColorDisabled:i,dividerColor:s,hoverColor:u,fontSizeMedium:d,heightMedium:c}=e;return{menuBorderRadius:n,menuColor:l,menuBoxShadow:t,menuDividerColor:s,menuHeight:"calc(var(--n-option-height) * 6.6)",optionArrowColor:o,optionHeight:c,optionFontSize:d,optionColorHover:u,optionTextColor:a,optionTextColorActive:r,optionTextColorDisabled:i,optionCheckMarkColor:r,loadingColor:r,columnWidth:"180px"}}});function ve(e){return e?e.map((e=>e.rawNode)):null}function pe(e,n,t){const l=[];for(;e;)l.push(e.rawNode[t]),e=e.parent;return l.reverse().join(n)}const fe=F("n-cascader"),me=e({name:"NCascaderOption",props:{tmNode:{type:Object,required:!0}},setup(e){const{expandTriggerRef:n,remoteRef:t,multipleRef:l,mergedValueRef:a,checkedKeysRef:o,indeterminateKeysRef:s,hoverKeyPathRef:u,keyboardKeyRef:d,loadingKeySetRef:c,cascadeRef:h,mergedCheckStrategyRef:v,onLoadRef:p,mergedClsPrefixRef:f,mergedThemeRef:m,labelFieldRef:g,showCheckboxRef:b,updateHoverKey:y,updateKeyboardKey:w,addLoadingKey:k,deleteLoadingKey:x,closeMenu:C,doCheck:R,doUncheck:S,renderLabelRef:M}=r(fe),T=i((()=>e.tmNode.key)),N=i((()=>{const{value:e}=n,{value:l}=t;return!l&&"hover"===e})),F=i((()=>{if(N.value)return U})),O=i((()=>{if(N.value)return q})),K=P((()=>{const{value:e}=l;return e?o.value.includes(T.value):a.value===T.value})),A=P((()=>!!l.value&&s.value.includes(T.value))),L=P((()=>u.value.includes(T.value))),z=P((()=>{const{value:e}=d;return null!==e&&e===T.value})),I=P((()=>!!t.value&&c.value.has(T.value))),j=i((()=>e.tmNode.isLeaf)),D=i((()=>e.tmNode.disabled)),V=i((()=>e.tmNode.rawNode[g.value])),H=i((()=>e.tmNode.shallowLoaded));function U(){if(!N.value||D.value)return;const{value:e}=T;y(e),w(e)}function q(){N.value&&U()}function E(){const{value:e}=l,{value:n}=T;e?A.value||K.value?S(n):R(n):(R(n),C(!0))}return{checkStrategy:v,multiple:l,cascade:h,checked:K,indeterminate:A,hoverPending:L,keyboardPending:z,isLoading:I,showCheckbox:b,isLeaf:j,disabled:D,label:V,mergedClsPrefix:f,mergedTheme:m,handleClick:function(n){if(D.value)return;const{value:l}=t,{value:a}=c,{value:o}=p,{value:r}=T,{value:i}=j,{value:s}=H;B(n,"checkbox")||(l&&!s&&!a.has(r)&&o&&(k(r),o(e.tmNode.rawNode).then((()=>{x(r)})).catch((()=>{x(r)}))),y(r),w(r)),i&&E()},handleCheckboxUpdateValue:function(){const{value:e}=j;e||E()},mergedHandleMouseEnter:F,mergedHandleMouseMove:O,renderLabel:M}},render(){const{mergedClsPrefix:e,renderLabel:n}=this;return a("div",{class:["".concat(e,"-cascader-option"),{["".concat(e,"-cascader-option--pending")]:this.keyboardPending||this.hoverPending,["".concat(e,"-cascader-option--disabled")]:this.disabled,["".concat(e,"-cascader-option--show-prefix")]:this.showCheckbox}],onMouseenter:this.mergedHandleMouseEnter,onMousemove:this.mergedHandleMouseMove,onClick:this.handleClick},this.showCheckbox?a("div",{class:"".concat(e,"-cascader-option__prefix")},a(ue,{focusable:!1,"data-checkbox":!0,disabled:this.disabled,checked:this.checked,indeterminate:this.indeterminate,theme:this.mergedTheme.peers.Checkbox,themeOverrides:this.mergedTheme.peerOverrides.Checkbox,onUpdateChecked:this.handleCheckboxUpdateValue})):null,a("span",{class:"".concat(e,"-cascader-option__label")},n?n(this.tmNode.rawNode,this.checked):this.label),a("div",{class:"".concat(e,"-cascader-option__suffix")},a("div",{class:"".concat(e,"-cascader-option-icon-placeholder")},this.isLeaf?"child"!==this.checkStrategy||this.multiple&&this.cascade?null:a(o,{name:"fade-in-scale-up-transition"},{default:()=>this.checked?a(K,{clsPrefix:e,class:"".concat(e,"-cascader-option-icon ").concat(e,"-cascader-option-icon--checkmark")},{default:()=>a(f,null)}):null}):a(O,{clsPrefix:e,scale:.85,strokeWidth:24,show:this.isLoading,class:"".concat(e,"-cascader-option-icon")},{default:()=>a(K,{clsPrefix:e,key:"arrow",class:"".concat(e,"-cascader-option-icon ").concat(e,"-cascader-option-icon--arrow")},{default:()=>a(A,null)})}))))}}),ge=e({name:"CascaderSubmenu",props:{depth:{type:Number,required:!0},tmNodes:{type:Array,required:!0}},setup(){const{virtualScrollRef:e,mergedClsPrefixRef:n,mergedThemeRef:l,optionHeightRef:a}=r(fe),o=t(null),s=t(null),u={scroll(n,t){var l,a;e.value?null===(l=s.value)||void 0===l||l.scrollTo({index:n}):null===(a=o.value)||void 0===a||a.scrollTo({index:n,elSize:t})}};return Object.assign({mergedClsPrefix:n,mergedTheme:l,scrollbarInstRef:o,vlInstRef:s,virtualScroll:e,itemSize:i((()=>L(a.value))),handleVlScroll:()=>{var e;null===(e=o.value)||void 0===e||e.sync()},getVlContainer:()=>{var e;return null===(e=s.value)||void 0===e?void 0:e.listElRef},getVlContent:()=>{var e;return null===(e=s.value)||void 0===e?void 0:e.itemsElRef}},u)},render(){const{mergedClsPrefix:e,mergedTheme:n,virtualScroll:t}=this;return a("div",{class:[t&&"".concat(e,"-cascader-submenu--virtual"),"".concat(e,"-cascader-submenu")]},a(z,{ref:"scrollbarInstRef",theme:n.peers.Scrollbar,themeOverrides:n.peerOverrides.Scrollbar,container:t?this.getVlContainer:void 0,content:t?this.getVlContent:void 0},{default:()=>t?a(m,{items:this.tmNodes,itemSize:this.itemSize,onScroll:this.handleVlScroll,showScrollbar:!1,ref:"vlInstRef"},{default:({item:e})=>a(me,{key:e.key,tmNode:e})}):this.tmNodes.map((e=>a(me,{key:e.key,tmNode:e})))}))}}),be=e({name:"NCascaderMenu",props:{value:[String,Number,Array],placement:{type:String,default:"bottom-start"},show:Boolean,menuModel:{type:Array,required:!0},loading:Boolean,onFocus:{type:Function,required:!0},onBlur:{type:Function,required:!0},onKeydown:{type:Function,required:!0},onMousedown:{type:Function,required:!0},onTabout:{type:Function,required:!0}},setup(e){const{localeRef:n,isMountedRef:l,mergedClsPrefixRef:a,syncCascaderMenuPosition:o,handleCascaderMenuClickOutside:i,mergedThemeRef:s}=r(fe),u=[],d=t(null),c=t(null);g(c,(function(){o()}));const h={scroll(e,n,t){const l=u[e];l&&l.scroll(n,t)},showErrorMessage:function(e){var t;const{value:{loadingRequiredMessage:l}}=n;null===(t=d.value)||void 0===t||t.showOnce(l(e))}};return Object.assign({isMounted:l,mergedClsPrefix:a,selfElRef:c,submenuInstRefs:u,maskInstRef:d,mergedTheme:s,handleFocusin:function(n){const{value:t}=c;t&&(t.contains(n.relatedTarget)||e.onFocus(n))},handleFocusout:function(n){const{value:t}=c;t&&(t.contains(n.relatedTarget)||e.onBlur(n))},handleClickOutside:function(e){i(e)}},h)},render(){const{submenuInstRefs:e,mergedClsPrefix:n,mergedTheme:t}=this;return a(o,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>this.show?s(a("div",{tabindex:"0",ref:"selfElRef",class:"".concat(n,"-cascader-menu"),onMousedown:this.onMousedown,onFocusin:this.handleFocusin,onFocusout:this.handleFocusout,onKeydown:this.onKeydown},this.menuModel[0].length?a("div",{class:"".concat(n,"-cascader-submenu-wrapper")},this.menuModel.map(((n,t)=>a(ge,{ref:n=>{n&&(e[t]=n)},key:t,tmNodes:n,depth:t+1}))),a(ce,{clsPrefix:n,ref:"maskInstRef"})):a("div",{class:"".concat(n,"-cascader-menu__empty")},j(this.$slots.empty,(()=>[a(D,{theme:t.peers.Empty,themeOverrides:t.peerOverrides.Empty})]))),V(this.$slots.action,(e=>e&&a("div",{class:"".concat(n,"-cascader-menu-action"),"data-action":!0},e))),a(b,{onFocus:this.onTabout})),[[I,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),ye=e({name:"NCascaderSelectMenu",props:{value:{type:[String,Number,Array],default:null},show:Boolean,pattern:{type:String,default:""},multiple:Boolean,tmNodes:{type:Array,default:()=>[]},filter:Function,labelField:{type:String,required:!0},separator:{type:String,required:!0}},setup(e){const{isMountedRef:n,mergedValueRef:l,mergedClsPrefixRef:a,mergedThemeRef:o,mergedCheckStrategyRef:s,slots:u,syncSelectMenuPosition:d,closeMenu:c,handleSelectMenuClickOutside:h,doUncheck:v,doCheck:p,clearPattern:f}=r(fe),m=t(null),g=i((()=>function(e,n,t,l){const a=[],o=[];return function e(r){for(const i of r){if(i.disabled)continue;const{rawNode:r}=i;o.push(r),!i.isLeaf&&n||a.push({label:pe(i,l,t),value:i.key,rawNode:i.rawNode,path:Array.from(o)}),!i.isLeaf&&i.children&&e(i.children),o.pop()}}(e),a}(e.tmNodes,"child"===s.value,e.labelField,e.separator))),b=i((()=>{const{filter:n}=e;if(n)return n;const{labelField:t}=e;return(e,n,l)=>l.some((n=>n[t]&&~n[t].indexOf(e)))})),y=i((()=>{const{pattern:n}=e,{value:t}=b;return(n?g.value.filter((e=>t(n,e.rawNode,e.path))):g.value).map((e=>({value:e.value,label:e.label})))})),k=i((()=>H(y.value,w("value","children"))));function x(n){if(e.multiple){const{value:e}=l;Array.isArray(e)?e.includes(n.key)?v(n.key):p(n.key):null===e&&p(n.key),f()}else p(n.key),c(!0)}const C={prev:function(){var e;null===(e=m.value)||void 0===e||e.prev()},next:function(){var e;null===(e=m.value)||void 0===e||e.next()},enter:function(){var e;if(m){const n=null===(e=m.value)||void 0===e?void 0:e.getPendingTmNode();return n&&x(n),!0}return!1}};return Object.assign({isMounted:n,mergedTheme:o,mergedClsPrefix:a,menuInstRef:m,selectTreeMate:k,handleResize:function(){d()},handleToggle:function(e){x(e)},handleClickOutside:function(e){h(e)},cascaderSlots:u},C)},render(){const{mergedClsPrefix:e,isMounted:n,mergedTheme:t,cascaderSlots:l}=this;return a(o,{name:"fade-in-scale-up-transition",appear:n},{default:()=>this.show?s(a(y,{ref:"menuInstRef",onResize:this.handleResize,clsPrefix:e,class:"".concat(e,"-cascader-menu"),autoPending:!0,themeOverrides:t.peerOverrides.InternalSelectMenu,theme:t.peers.InternalSelectMenu,treeMate:this.selectTreeMate,multiple:this.multiple,value:this.value,onToggle:this.handleToggle},{empty:()=>j(l["not-found"],(()=>[]))}),[[I,this.handleClickOutside,void 0,{capture:!0}]]):null})}}),we=U([x("cascader-menu","\n outline: none;\n position: relative;\n margin: 4px 0;\n display: flex;\n flex-flow: column nowrap;\n border-radius: var(--n-menu-border-radius);\n overflow: hidden;\n box-shadow: var(--n-menu-box-shadow);\n color: var(--n-option-text-color);\n background-color: var(--n-menu-color);\n ",[q({transformOrigin:"inherit",duration:"0.2s"}),E("empty","\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n "),x("scrollbar",{width:"100%"}),x("base-menu-mask",{backgroundColor:"var(--n-menu-mask-color)"}),x("base-loading",{color:"var(--n-loading-color)"}),x("cascader-submenu-wrapper","\n position: relative;\n display: flex;\n flex-wrap: nowrap;\n "),x("cascader-submenu","\n height: var(--n-menu-height);\n min-width: var(--n-column-width);\n position: relative;\n ",[$("virtual","\n width: var(--n-column-width);\n "),x("scrollbar-content",{position:"relative"}),U("&:first-child","\n border-top-left-radius: var(--n-menu-border-radius);\n border-bottom-left-radius: var(--n-menu-border-radius);\n "),U("&:last-child","\n border-top-right-radius: var(--n-menu-border-radius);\n border-bottom-right-radius: var(--n-menu-border-radius);\n "),U("&:not(:first-child)","\n border-left: 1px solid var(--n-menu-divider-color);\n ")]),x("cascader-menu-action","\n box-sizing: border-box;\n padding: 8px;\n border-top: 1px solid var(--n-menu-divider-color);\n "),x("cascader-option","\n height: var(--n-option-height);\n line-height: var(--n-option-height);\n font-size: var(--n-option-font-size);\n padding: 0 0 0 18px;\n box-sizing: border-box;\n min-width: 182px;\n background-color: #0000;\n display: flex;\n align-items: center;\n white-space: nowrap;\n position: relative;\n cursor: pointer;\n transition:\n background-color .2s var(--n-bezier),\n color 0.2s var(--n-bezier);\n ",[$("show-prefix",{paddingLeft:0}),E("label","\n flex: 1 0 0;\n overflow: hidden;\n text-overflow: ellipsis;\n "),E("prefix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),E("suffix",{width:"32px",display:"flex",alignItems:"center",justifyContent:"center"}),x("cascader-option-icon-placeholder",{lineHeight:0,position:"relative",width:"16px",height:"16px",fontSize:"16px"},[x("cascader-option-icon",[$("checkmark",{color:"var(--n-option-check-mark-color)"},[q({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})]),$("arrow",{color:"var(--n-option-arrow-color)"})])]),$("selected",{color:"var(--n-option-text-color-active)"}),$("active",{color:"var(--n-option-text-color-active)",backgroundColor:"var(--n-option-color-hover)"}),$("pending",{backgroundColor:"var(--n-option-color-hover)"}),U("&:hover",{backgroundColor:"var(--n-option-color-hover)"}),$("disabled","\n color: var(--n-option-text-color-disabled);\n background-color: #0000;\n cursor: not-allowed;\n ",[x("cascader-option-icon",[$("arrow",{color:"var(--n-option-text-color-disabled)"})])])])]),x("cascader","\n z-index: auto;\n position: relative;\n width: 100%;\n ")]),ke=e({name:"Cascader",props:Object.assign(Object.assign({},W.props),{allowCheckingNotLoaded:Boolean,to:X.propTo,bordered:{type:Boolean,default:void 0},options:{type:Array,default:()=>[]},value:[String,Number,Array],defaultValue:{type:[String,Number,Array],default:null},placeholder:String,multiple:Boolean,size:String,filterable:Boolean,disabled:{type:Boolean,default:void 0},disabledField:{type:String,default:"disabled"},expandTrigger:{type:String,default:"click"},clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},remote:Boolean,onLoad:Function,separator:{type:String,default:" / "},filter:Function,placement:{type:String,default:"bottom-start"},cascade:{type:Boolean,default:!0},leafOnly:Boolean,showPath:{type:Boolean,default:!0},show:{type:Boolean,default:void 0},maxTagCount:[String,Number],menuProps:Object,filterMenuProps:Object,virtualScroll:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},valueField:{type:String,default:"value"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},renderLabel:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onBlur:Function,onFocus:Function,onChange:[Function,Array]}),setup(e,{slots:l}){const{mergedBorderedRef:a,mergedClsPrefixRef:o,namespaceRef:r,inlineThemeDisabled:s}=_(e),v=W("Cascader","-cascader",we,he,e,o),{localeRef:p}=G("Cascader"),f=t(e.defaultValue),m=i((()=>e.value)),g=J(m,f),b=i((()=>e.leafOnly?"child":e.checkStrategy)),y=t(""),w=Q(e),{mergedSizeRef:k,mergedDisabledRef:x,mergedStatusRef:C}=w,R=t(null),S=t(null),M=t(null),T=t(null),N=t(null),F=t(new Set),P=t(null),O=t(null),K=X(e),A=t(!1),z=e=>{F.value.add(e)},I=e=>{F.value.delete(e)},j=i((()=>{const{valueField:n,childrenField:t,disabledField:l}=e;return H(e.options,{getDisabled:e=>e[l],getKey:e=>e[n],getChildren:e=>e[t]})})),D=i((()=>{const{cascade:n,multiple:t}=e;return t&&Array.isArray(g.value)?j.value.getCheckedKeys(g.value,{cascade:n,allowNotLoaded:e.allowCheckingNotLoaded}):{checkedKeys:[],indeterminateKeys:[]}})),V=i((()=>D.value.checkedKeys)),U=i((()=>D.value.indeterminateKeys)),q=i((()=>{const{treeNodePath:e,treeNode:n}=j.value.getPath(N.value);let t;return null===n?t=[j.value.treeNodes]:(t=e.map((e=>e.siblings)),n.isLeaf||F.value.has(n.key)||!n.children||t.push(n.children)),t})),E=i((()=>{const{keyPath:e}=j.value.getPath(N.value);return e})),$=i((()=>v.value.self.optionHeight));function ne(n){const{onUpdateShow:t,"onUpdate:show":l}=e;t&&ie(t,n),l&&ie(l,n),be.value=n}function te(n,t,l){const{onUpdateValue:a,"onUpdate:value":o,onChange:r}=e,{nTriggerFormInput:i,nTriggerFormChange:s}=w;a&&ie(a,n,t,l),o&&ie(o,n,t,l),r&&ie(r,n,t,l),f.value=n,i(),s()}function le(e){T.value=e}function se(e){N.value=e}function ue(e){const{value:{getNode:n}}=j;return e.map((e=>{var t;return(null===(t=n(e))||void 0===t?void 0:t.rawNode)||null}))}function de(n){var t;const{cascade:l,multiple:a,filterable:o}=e,{value:{check:r,getNode:i,getPath:s}}=j;if(a)try{const{checkedKeys:t}=r(n,D.value.checkedKeys,{cascade:l,checkStrategy:b.value,allowNotLoaded:e.allowCheckingNotLoaded});te(t,ue(t),t.map((e=>{var n;return ve(null===(n=s(e))||void 0===n?void 0:n.treeNodePath)}))),o&&Me(),T.value=n,N.value=n}catch(u){if(!(u instanceof ae))throw u;if(R.value){const t=i(n);null!==t&&R.value.showErrorMessage(t.rawNode[e.labelField])}}else if("child"===b.value){const e=i(n);if(!(null==e?void 0:e.isLeaf))return!1;te(n,e.rawNode,ve(s(n).treeNodePath))}else{const e=i(n);te(n,(null==e?void 0:e.rawNode)||null,ve(null===(t=s(n))||void 0===t?void 0:t.treeNodePath))}return!0}function ce(n){const{cascade:t,multiple:l}=e;if(l){const{value:{uncheck:l,getNode:a,getPath:o}}=j,{checkedKeys:r}=l(n,D.value.checkedKeys,{cascade:t,checkStrategy:b.value,allowNotLoaded:e.allowCheckingNotLoaded});te(r,r.map((e=>{var n;return(null===(n=a(e))||void 0===n?void 0:n.rawNode)||null})),r.map((e=>{var n;return ve(null===(n=o(e))||void 0===n?void 0:n.treeNodePath)}))),T.value=n,N.value=n}}u(e.options)&&d(e.options,((e,n)=>{e!==n&&(N.value=null,T.value=null)}));const me=i((()=>{if(e.multiple){const{showPath:n,separator:t,labelField:l,cascade:a}=e,{getCheckedKeys:o,getNode:r}=j.value;return o(V.value,{cascade:a,checkStrategy:b.value,allowNotLoaded:e.allowCheckingNotLoaded}).checkedKeys.map((e=>{const a=r(e);return null===a?{label:String(e),value:e}:{label:n?pe(a,t,l):a.rawNode[l],value:a.key}}))}return[]})),ge=i((()=>{const{multiple:n,showPath:t,separator:l,labelField:a}=e,{value:o}=g;if(n||Array.isArray(o))return null;{const{getNode:e}=j.value;if(null===o)return null;const n=e(o);return null===n?{label:String(o),value:o}:{label:t?pe(n,l,a):n.rawNode[a],value:n.key}}})),be=t(!1),ye=n(e,"show"),ke=J(ye,be),xe=i((()=>{const{placeholder:n}=e;return void 0!==n?n:p.value.placeholder})),Ce=i((()=>!(!e.filterable||!y.value)));function Re(n){const{onBlur:t}=e,{nTriggerFormBlur:l}=w;t&&ie(t,n),l()}function Se(n){const{onFocus:t}=e,{nTriggerFormFocus:l}=w;t&&ie(t,n),l()}function Me(){var e;null===(e=M.value)||void 0===e||e.focusInput()}function Te(){x.value||(y.value="",ne(!0),e.filterable&&Me())}function Ne(e=!1){var n;e&&(null===(n=M.value)||void 0===n||n.focus()),ne(!1),y.value=""}function Fe(e){var n;Ce.value||ke.value&&((null===(n=M.value)||void 0===n?void 0:n.$el.contains(oe(e)))||Ne())}function Pe(){e.clearFilterAfterSelect&&(y.value="")}function Oe(n){var t,l,a;const{value:o}=T,{value:r}=j;switch(n){case"prev":if(null!==o){const e=r.getPrev(o,{loop:!0});null!==e&&(le(e.key),null===(t=R.value)||void 0===t||t.scroll(e.level,e.index,L($.value)))}break;case"next":if(null===o){const e=r.getFirstAvailableNode();null!==e&&(le(e.key),null===(l=R.value)||void 0===l||l.scroll(e.level,e.index,L($.value)))}else{const e=r.getNext(o,{loop:!0});null!==e&&(le(e.key),null===(a=R.value)||void 0===a||a.scroll(e.level,e.index,L($.value)))}break;case"child":if(null!==o){const n=r.getNode(o);if(null!==n)if(n.shallowLoaded){const e=r.getChild(o);null!==e&&(se(o),le(e.key))}else{const{value:t}=F;if(!t.has(o)){z(o),se(o);const{onLoad:t}=e;t&&t(n.rawNode).then((()=>{I(o)})).catch((()=>{I(o)}))}}}break;case"parent":if(null!==o){const e=r.getParent(o);if(null!==e){le(e.key);const n=e.getParent();se(null===n?null:n.key)}}}}function Ke(n){var t,l;switch(n.key){case" ":case"ArrowDown":case"ArrowUp":if(e.filterable&&ke.value)break;n.preventDefault()}if(!B(n,"action"))switch(n.key){case" ":if(e.filterable)return;case"Enter":if(ke.value){const{value:n}=Ce,{value:t}=T;if(n){if(S.value){S.value.enter()&&Pe()}}else if(null!==t)if(V.value.includes(t)||U.value.includes(t))ce(t);else{const n=de(t);!e.multiple&&n&&Ne(!0)}}else Te();break;case"ArrowUp":n.preventDefault(),ke.value&&(Ce.value?null===(t=S.value)||void 0===t||t.prev():Oe("prev"));break;case"ArrowDown":n.preventDefault(),ke.value?Ce.value?null===(l=S.value)||void 0===l||l.next():Oe("next"):Te();break;case"ArrowLeft":n.preventDefault(),ke.value&&!Ce.value&&Oe("parent");break;case"ArrowRight":n.preventDefault(),ke.value&&!Ce.value&&Oe("child");break;case"Escape":ke.value&&(re(n),Ne(!0))}}function Ae(){var e;null===(e=P.value)||void 0===e||e.syncPosition()}function Be(){var e;null===(e=O.value)||void 0===e||e.syncPosition()}d(ke,(n=>{if(!n)return;if(e.multiple)return;const{value:t}=g;Array.isArray(t)||null===t?(T.value=null,N.value=null):(T.value=t,N.value=t,c((()=>{var e;if(!ke.value)return;const{value:n}=N;if(null!==g.value){const t=j.value.getNode(n);t&&(null===(e=R.value)||void 0===e||e.scroll(t.level,t.index,L($.value)))}})))}),{immediate:!0});const Le=i((()=>!(!e.multiple||!e.cascade)||"child"!==b.value));h(fe,{slots:l,mergedClsPrefixRef:o,mergedThemeRef:v,mergedValueRef:g,checkedKeysRef:V,indeterminateKeysRef:U,hoverKeyPathRef:E,mergedCheckStrategyRef:b,showCheckboxRef:Le,cascadeRef:n(e,"cascade"),multipleRef:n(e,"multiple"),keyboardKeyRef:T,hoverKeyRef:N,remoteRef:n(e,"remote"),loadingKeySetRef:F,expandTriggerRef:n(e,"expandTrigger"),isMountedRef:Y(),onLoadRef:n(e,"onLoad"),virtualScrollRef:n(e,"virtualScroll"),optionHeightRef:$,localeRef:p,labelFieldRef:n(e,"labelField"),renderLabelRef:n(e,"renderLabel"),syncCascaderMenuPosition:Be,syncSelectMenuPosition:Ae,updateKeyboardKey:le,updateHoverKey:se,addLoadingKey:z,deleteLoadingKey:I,doCheck:de,doUncheck:ce,closeMenu:Ne,handleSelectMenuClickOutside:function(e){Ce.value&&Fe(e)},handleCascaderMenuClickOutside:Fe,clearPattern:Pe});const ze={focus:()=>{var e;null===(e=M.value)||void 0===e||e.focus()},blur:()=>{var e;null===(e=M.value)||void 0===e||e.blur()},getCheckedData:()=>{if(Le.value){const e=V.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}},getIndeterminateData:()=>{if(Le.value){const e=U.value;return{keys:e,options:ue(e)}}return{keys:[],options:[]}}},Ie=i((()=>{const{self:{optionArrowColor:e,optionTextColor:n,optionTextColorActive:t,optionTextColorDisabled:l,optionCheckMarkColor:a,menuColor:o,menuBoxShadow:r,menuDividerColor:i,menuBorderRadius:s,menuHeight:u,optionColorHover:d,optionHeight:c,optionFontSize:h,loadingColor:p,columnWidth:f},common:{cubicBezierEaseInOut:m}}=v.value;return{"--n-bezier":m,"--n-menu-border-radius":s,"--n-menu-box-shadow":r,"--n-menu-height":u,"--n-column-width":f,"--n-menu-color":o,"--n-menu-divider-color":i,"--n-option-height":c,"--n-option-font-size":h,"--n-option-text-color":n,"--n-option-text-color-disabled":l,"--n-option-text-color-active":t,"--n-option-color-hover":d,"--n-option-check-mark-color":a,"--n-option-arrow-color":e,"--n-menu-mask-color":Z(o,{alpha:.75}),"--n-loading-color":p}})),je=s?ee("cascader",void 0,Ie,e):void 0;return Object.assign(Object.assign({},ze),{handleTriggerResize:function(){ke.value&&(Ce.value?Ae():Be())},mergedStatus:C,selectMenuFollowerRef:P,cascaderMenuFollowerRef:O,triggerInstRef:M,selectMenuInstRef:S,cascaderMenuInstRef:R,mergedBordered:a,mergedClsPrefix:o,namespace:r,mergedValue:g,mergedShow:ke,showSelectMenu:Ce,pattern:y,treeMate:j,mergedSize:k,mergedDisabled:x,localizedPlaceholder:xe,selectedOption:ge,selectedOptions:me,adjustedTo:K,menuModel:q,handleMenuTabout:function(){Ne(!0)},handleMenuFocus:function(e){var n;(null===(n=M.value)||void 0===n?void 0:n.$el.contains(e.relatedTarget))||(A.value=!0,Se(e))},handleMenuBlur:function(e){var n;(null===(n=M.value)||void 0===n?void 0:n.$el.contains(e.relatedTarget))||(A.value=!1,Re(e))},handleMenuKeydown:function(e){Ke(e)},handleMenuMousedown:function(n){B(n,"action")||e.multiple&&e.filter&&(n.preventDefault(),Me())},handleTriggerFocus:function(e){var n;(null===(n=R.value)||void 0===n?void 0:n.$el.contains(e.relatedTarget))||(A.value=!0,Se(e))},handleTriggerBlur:function(e){var n;(null===(n=R.value)||void 0===n?void 0:n.$el.contains(e.relatedTarget))||(A.value=!1,Re(e),Ne())},handleTriggerClick:function(){e.filterable?Te():ke.value?Ne(!0):Te()},handleClear:function(n){n.stopPropagation(),e.multiple?te([],[],[]):te(null,null,null)},handleDeleteOption:function(n){const{multiple:t}=e,{value:l}=g;t&&Array.isArray(l)&&void 0!==n.value?ce(n.value):te(null,null,null)},handlePatternInput:function(e){y.value=e.target.value},handleKeydown:Ke,focused:A,optionHeight:$,mergedTheme:v,cssVars:s?void 0:Ie,themeClass:null==je?void 0:je.themeClass,onRender:null==je?void 0:je.onRender})},render(){const{mergedClsPrefix:e}=this;return a("div",{class:"".concat(e,"-cascader")},a(ne,null,{default:()=>[a(te,null,{default:()=>a(k,{onResize:this.handleTriggerResize,ref:"triggerInstRef",status:this.mergedStatus,clsPrefix:e,maxTagCount:this.maxTagCount,bordered:this.mergedBordered,size:this.mergedSize,theme:this.mergedTheme.peers.InternalSelection,themeOverrides:this.mergedTheme.peerOverrides.InternalSelection,active:this.mergedShow,pattern:this.pattern,placeholder:this.localizedPlaceholder,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,multiple:this.multiple,filterable:this.filterable,clearable:this.clearable,disabled:this.mergedDisabled,focused:this.focused,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onClick:this.handleTriggerClick,onClear:this.handleClear,onDeleteOption:this.handleDeleteOption,onPatternInput:this.handlePatternInput,onKeydown:this.handleKeydown},{arrow:()=>{var e,n;return null===(n=(e=this.$slots).arrow)||void 0===n?void 0:n.call(e)}})}),a(le,{key:"cascaderMenu",ref:"cascaderMenuFollowerRef",show:this.mergedShow&&!this.showSelectMenu,containerClass:this.namespace,placement:this.placement,width:this.options.length?void 0:"target",teleportDisabled:this.adjustedTo===X.tdkey,to:this.adjustedTo},{default:()=>{var e;null===(e=this.onRender)||void 0===e||e.call(this);const{menuProps:n}=this;return a(be,Object.assign({},n,{ref:"cascaderMenuInstRef",class:[this.themeClass,null==n?void 0:n.class],value:this.mergedValue,show:this.mergedShow&&!this.showSelectMenu,menuModel:this.menuModel,style:[this.cssVars,null==n?void 0:n.style],onFocus:this.handleMenuFocus,onBlur:this.handleMenuBlur,onKeydown:this.handleMenuKeydown,onMousedown:this.handleMenuMousedown,onTabout:this.handleMenuTabout}),{action:()=>{var e,n;return null===(n=(e=this.$slots).action)||void 0===n?void 0:n.call(e)},empty:()=>{var e,n;return null===(n=(e=this.$slots).empty)||void 0===n?void 0:n.call(e)}})}}),a(le,{key:"selectMenu",ref:"selectMenuFollowerRef",show:this.mergedShow&&this.showSelectMenu,containerClass:this.namespace,width:"target",placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===X.tdkey},{default:()=>{var e;null===(e=this.onRender)||void 0===e||e.call(this);const{filterMenuProps:n}=this;return a(ye,Object.assign({},n,{ref:"selectMenuInstRef",class:[this.themeClass,null==n?void 0:n.class],value:this.mergedValue,show:this.mergedShow&&this.showSelectMenu,pattern:this.pattern,multiple:this.multiple,tmNodes:this.treeMate.treeNodes,filter:this.filter,labelField:this.labelField,separator:this.separator,style:[this.cssVars,null==n?void 0:n.style]}))}})]}))}});export{ke as _};
