import{_ as e}from"./index.vue_vue_type_script_setup_true_lang.609fbee0.1742181728921.js";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.6f36d91a.1742181728921.js";import{B as l,D as a,L as s,F as i,G as n,P as o,I as r,a9 as d,h as u,$ as c,aa as p,ab as v,ac as m,f,_,ad as h,ae as y,t as x,o as S,a1 as w,x as b,af as g,a7 as k,V as C,ag as M,ah as T,ai as P,aj as L,A as U,a3 as $,ak as A,u as R,al as D,r as B,z as j,y as z,m as I,T as W,am as N,an as F,ao as E,l as K,n as q,a6 as H,g as V,ap as O,aq as X,e as G,ar as Q,as as J,at as Z,W as Y,au as ee,av as te,R as le,aw as ae,ax as se,k as ie,ay as ne,az as oe,aA as re,aB as de,S as ue,aC as ce,aD as pe,aE as ve,aF as me}from"./index.fc641b56.1742181728921.js";import{_ as fe}from"./index.vue_vue_type_script_setup_true_lang.5eb11789.1742181728921.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang.dd273c02.1742181728921.js";import{d as he,c as ye,h as xe,x as Se,m as we,X as be,W as ge,r as ke,P as Ce,o as Me,S as Te,U as Pe,$ as Le,f as Ue,e as $e,k as Ae,_ as Re,Z as De,aa as Be,a2 as je,a3 as ze,B as Ie,s as We,F as Ne,u as Fe,b as Ee,y as Ke,l as qe,K as He,ae as Ve,a as Oe,ac as Xe,a5 as Ge,ad as Qe,G as Je,ab as Ze,a6 as Ye}from"./vue.314199b7.1742181728921.js";import{_ as et,a as tt}from"./Checkbox.64335fca.1742181728921.js";import{_ as lt}from"./index.vue_vue_type_script_setup_true_lang.141d1f64.1742181728921.js";import{u as at}from"./auth.03aa3fe5.1742181728921.js";import{a as st,d as it}from"./area.05904c14.1742181728921.js";import{_ as nt}from"./pro.1e612477.1742181728921.js";import{_ as ot}from"./index.2dfef82f.1742181728921.js";import{_ as rt}from"./mode.vue_vue_type_script_setup_true_lang.c854f42f.1742181728921.js";import{N as dt}from"./Switch.4c664df7.1742181728921.js";import{_ as ut}from"./index.29125cc8.1742181728921.js";import{b as ct,_ as pt,c as vt,a as mt}from"./DataTable.762c357a.1742181728921.js";import{_ as ft,N as _t}from"./Upload.f79a3f43.1742181728921.js";import{_ as ht}from"./CollapseTransition.41388482.1742181728921.js";import{N as yt}from"./InputNumber.f6532dc5.1742181728921.js";import{_ as xt,a as St}from"./index.70c036f2.1742181728921.js";import{_ as wt}from"./index.0a184dde.1742181728921.js";import{a as bt,_ as gt}from"./Grid.d5994465.1742181728921.js";import"./layer.8f9c8930.1742181728921.js";import"./get-slot.a0e67e91.1742181728921.js";import"./utils.d31cac41.1742181728921.js";const kt={headerFontSize1:"30px",headerFontSize2:"22px",headerFontSize3:"18px",headerFontSize4:"16px",headerFontSize5:"16px",headerFontSize6:"16px",headerMargin1:"28px 0 20px 0",headerMargin2:"28px 0 20px 0",headerMargin3:"28px 0 20px 0",headerMargin4:"28px 0 18px 0",headerMargin5:"28px 0 18px 0",headerMargin6:"28px 0 18px 0",headerPrefixWidth1:"16px",headerPrefixWidth2:"16px",headerPrefixWidth3:"12px",headerPrefixWidth4:"12px",headerPrefixWidth5:"12px",headerPrefixWidth6:"12px",headerBarWidth1:"4px",headerBarWidth2:"4px",headerBarWidth3:"3px",headerBarWidth4:"3px",headerBarWidth5:"3px",headerBarWidth6:"3px",pMargin:"16px 0 16px 0",liMargin:".25em 0 0 0",olPadding:"0 0 0 2em",ulPadding:"0 0 0 2em"},Ct={name:"Typography",common:l,self:e=>{const{primaryColor:t,textColor2:l,borderColor:a,lineHeight:s,fontSize:i,borderRadiusSmall:n,dividerColor:o,fontWeightStrong:r,textColor1:d,textColor3:u,infoColor:c,warningColor:p,errorColor:v,successColor:m,codeColor:f}=e;return Object.assign(Object.assign({},kt),{aTextColor:t,blockquoteTextColor:l,blockquotePrefixColor:a,blockquoteLineHeight:s,blockquoteFontSize:i,codeBorderRadius:n,liTextColor:l,liLineHeight:s,liFontSize:i,hrColor:o,headerFontWeight:r,headerTextColor:d,pTextColor:l,pTextColor1Depth:d,pTextColor2Depth:l,pTextColor3Depth:u,pLineHeight:s,pFontSize:i,headerBarColor:t,headerBarColorPrimary:t,headerBarColorInfo:c,headerBarColorError:v,headerBarColorWarning:p,headerBarColorSuccess:m,textColor:l,textColor1Depth:d,textColor2Depth:l,textColor3Depth:u,textColorPrimary:t,textColorInfo:c,textColorSuccess:m,textColorWarning:p,textColorError:v,codeTextColor:l,codeColor:f,codeBorder:"1px solid #0000"})}},Mt=a("text","\n transition: color .3s var(--n-bezier);\n color: var(--n-text-color);\n",[s("strong","\n font-weight: var(--n-font-weight-strong);\n "),s("italic",{fontStyle:"italic"}),s("underline",{textDecoration:"underline"}),s("code","\n line-height: 1.4;\n display: inline-block;\n font-family: var(--n-font-famliy-mono);\n transition: \n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n box-sizing: border-box;\n padding: .05em .35em 0 .35em;\n border-radius: var(--n-code-border-radius);\n font-size: .9em;\n color: var(--n-code-text-color);\n background-color: var(--n-code-color);\n border: var(--n-code-border);\n ")]),Tt=he({name:"Text",props:Object.assign(Object.assign({},n.props),{code:Boolean,type:{type:String,default:"default"},delete:Boolean,strong:Boolean,italic:Boolean,underline:Boolean,depth:[String,Number],tag:String,as:{type:String,validator:()=>!0,default:void 0}}),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:l}=i(e),a=n("Typography","-text",Mt,Ct,e,t),s=ye((()=>{const{depth:t,type:l}=e,s="default"===l?void 0===t?"textColor":"textColor".concat(t,"Depth"):o("textColor",l),{common:{fontWeightStrong:i,fontFamilyMono:n,cubicBezierEaseInOut:r},self:{codeTextColor:d,codeBorderRadius:u,codeColor:c,codeBorder:p,[s]:v}}=a.value;return{"--n-bezier":r,"--n-text-color":v,"--n-font-weight-strong":i,"--n-font-famliy-mono":n,"--n-code-border-radius":u,"--n-code-text-color":d,"--n-code-color":c,"--n-code-border":p}})),u=l?r("text",ye((()=>"".concat(e.type[0]).concat(e.depth||""))),s,e):void 0;return{mergedClsPrefix:t,compitableTag:d(e,["as","tag"]),cssVars:l?void 0:s,themeClass:null==u?void 0:u.themeClass,onRender:null==u?void 0:u.onRender}},render(){var e,t,l;const{mergedClsPrefix:a}=this;null===(e=this.onRender)||void 0===e||e.call(this);const s=["".concat(a,"-text"),this.themeClass,{["".concat(a,"-text--code")]:this.code,["".concat(a,"-text--delete")]:this.delete,["".concat(a,"-text--strong")]:this.strong,["".concat(a,"-text--italic")]:this.italic,["".concat(a,"-text--underline")]:this.underline}],i=null===(l=(t=this.$slots).default)||void 0===l?void 0:l.call(t);return this.code?xe("code",{class:s,style:this.cssVars},this.delete?xe("del",null,i):i):this.delete?xe("del",{class:s,style:this.cssVars},i):xe(this.compitableTag||"span",{class:s,style:this.cssVars},i)}}),Pt=Symbol("server-list");function Lt(){return we(Pt)}const Ut={key:0,class:"alert"},$t={class:"mr-12px font-bold"},At=_(he({__name:"index",setup(e){const t=u(),{isFree:l}=be(t),{t:a}=ge(),s=ke(!1),i=()=>{c({title:a("Site.List.Try.Title"),content:a("Site.List.Try.Content"),confirmTitle:a("Site.List.Try.ConfrimBtn"),onConfirm:async()=>{await p(),v()}})};return(async()=>{const{res:e}=await m();s.value=0===e&&l.value})(),(e,t)=>{const l=f;return Ce(s)?(Me(),Te("div",Ut,[Pe("span",$t,Le(e.$t("Site.List.Try.Tips")),1),Ue(l,{type:"primary",size:"tiny",onClick:i},{default:$e((()=>[Ae(Le(e.$t("Site.List.Try.Btn")),1)])),_:1})])):Re("",!0)}}}),[["__scopeId","data-v-d9c57124"]]),Rt=e=>(je("data-v-f5753746"),e=e(),ze(),e),Dt={class:"flex items-center"},Bt=Rt((()=>Pe("span",{class:"ml-10px"},"拦截",-1))),jt=Rt((()=>Pe("span",null,"点击查看堡塔恶意IP库",-1))),zt=Rt((()=>Pe("span",null,"访问",-1))),It=_(he({__name:"index",setup(e){const{onAddSite:t}=Lt(),{t:l}=ge(),a=De(),s=u(),{userinfo:i}=be(s),n=ke(!1),o=()=>{a.push("/group")},r=async e=>{const{malicious_ip_shared:t}=i.value;!t&&e?c({title:l("Public.Confirm.Title"),content:l("Site.List.Intercept.Content"),confirmTitle:l("Site.List.Intercept.ConfrimBtn"),cancelTitle:l("Site.List.Intercept.CancelBtn"),onConfirm:e=>{a.push("/config"),e()},onPublicCancel:()=>{n.value=!1}}):await h({open:e?1:0,site_id:"",type:"global"})};return(async()=>{const{res:e}=await y();x(e)?n.value=1===e.malicious_ip.mode:n.value=!1})(),(e,l)=>{const a=f,s=S,i=w,d=et;return Me(),Te("div",Dt,[Ue(a,{type:"primary",onClick:Ce(t)},{default:$e((()=>[Ae(Le(e.$t("Site.List.AddBtn")),1)])),_:1},8,["onClick"]),Bt,Ue(i,{trigger:"hover"},{trigger:$e((()=>[Ue(s,{onClick:o},{default:$e((()=>[Ae("已知恶意IP")])),_:1})])),default:$e((()=>[jt])),_:1}),zt,Ue(d,{checked:Ce(n),"onUpdate:checked":[l[0]||(l[0]=e=>Be(n)?n.value=e:null),r],class:"ml-10px"},null,8,["checked"])])}}}),[["__scopeId","data-v-f5753746"]]),Wt={class:"inline-flex items-center"},Nt={class:"mr-8px"},Ft={class:"flex"},Et={class:"pb-4px"},Kt={class:"pt-4px"},qt=he({__name:"index",props:{upColor:{default:"#666"},downColor:{default:"#666"}},setup:e=>(e,t)=>{const l=b;return Me(),Te("div",Wt,[Pe("div",Nt,[Ie(e.$slots,"default")]),Pe("div",Ft,[Pe("div",Et,[Ue(l,{name:"byte-up",size:"12",color:e.upColor,style:{width:"6px"}},null,8,["color"])]),Pe("div",Kt,[Ue(l,{name:"byte-down",size:"12",color:e.downColor,style:{width:"6px"}},null,8,["color"])])])])}}),Ht={class:"w-340px"},Vt=Pe("div",{class:"text-[1.4rem] mb-1rem"},"批量证书续签执行情况",-1),Ot=he({__name:"batchTable",setup(e){const{data:t,key:l}=we("component-data")||{},a=ke([]),s=[{title:"站点名称",key:"site_name"},{title:"状态",key:"load_code",width:60,render:e=>0===e.load_code?"等待中":1===e.load_code?Ue(S,null,{default:()=>[Ae("成功")]}):Ue(Ne,null,[Ue("div",{title:e.load_code},[Ue(S,{type:"error",class:"truncate w-[12rem] justify-start"},{default:()=>[e.load_code]})])])}];return We((()=>{a.value=t.filter((e=>l.includes(e.site_id))).map((e=>({...e,load_code:0}))),(()=>{const e=async t=>{if(t>=a.value.length)return;const l=a.value[t];try{await g({site_id:l.site_id}),l.load_code=1}catch(s){l.load_code=s.res}await e(t+1)};e(0)})()})),(e,t)=>{const l=lt;return Me(),Te("div",Ht,[Vt,Ue(l,{data:Ce(a),columns:s},null,8,["data"])])}}});function Xt(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!qe(e)}const Gt=he({__name:"index",setup(e){const{t:l}=ge(),a=k(),{getList:s}=a,{loading:i,table:n}=be(a),{showSslModal:o,showCrawlerModal:r,showWaitModal:d}=Lt(),u=Fe({show:!1,data:{data:[],key:[]}}),p=ke([{type:"selection",width:36},{key:"site_name",title:l("Site.List.SiteName"),minWidth:150,render:e=>Ue(S,{onClick:()=>{m(e)}},{default:()=>[e.site_name||"--"]})},{key:"access",title:l("Site.List.Access"),width:"9%",minWidth:100,render:e=>Ue(Ne,null,[Ue("span",null,[e.access_num.toLocaleString()||0]),Ue("span",{class:"mx-2px"},[Ae("/")]),Ue("span",{class:"text-error"},[e.interception_num.toLocaleString()||0])])},{key:"real_time_send",width:"9%",minWidth:100,title:()=>{let e;return Ue("div",{class:"flex items-center"},[Ue(qt,{class:"mr-8px"},Xt(e=l("Site.List.Flow"))?e:{default:()=>[e]}),Ue(ot,null,{default:()=>[l("Site.List.Up"),Ue("br",null,null),l("Site.List.Down")]})])},render:e=>Ue(Ne,null,[Ue("div",null,[C(e.real_time_send)]),Ue("div",null,[C(e.real_time_recv)])])},{key:"ssl",title:l("Site.List.Ssl"),width:"9%",minWidth:90,render:e=>{let t="warning",a=l("Site.List.NonDeployed");const{server:s}=e,{ssl:i}=s;return 1===i.is_ssl&&(e.ssl_day>0?(t="primary",a=l("Site.List.Surplus",{day:e.ssl_day})):(t="error",a=l("Site.List.Expired"))),Ue(S,{type:t,onClick:()=>{h(e)}},Xt(a)?a:{default:()=>[a]})}},{key:"run",title:l("Site.List.Mode"),width:"10%",minWidth:140,render:e=>Ue(rt,{row:e,value:e.waf_info.mode,onRefresh:t=>{e.waf_info.mode=t,s(!1)}},null)},{key:"ccdefend",title:l("Site.List.Cc"),align:"center",width:"8%",minWidth:80,render:e=>{const t=e.waf_info.cc.open||e.waf_info.wait.open;return Ue(S,{class:"".concat(t?"text-[#20a53a]":"text-[#c6892e]"),onClick:()=>{d(e)}},{default:()=>[t?"已开启":"未开启"]})}},{key:"crawler",title:"爬虫防护",align:"center",width:"8%",minWidth:80,render:e=>{const t=e.waf_info.crawler.encryption.open;return Ue(S,{class:"".concat(t?"text-[#20a53a]":"text-[#c6892e]"),onClick:()=>{r(e)}},{default:()=>[t?"已开启":"未开启"]})}},{key:"smart_cc",align:"center",width:"8%",minWidth:110,title:()=>Ue("div",{class:"flex flex-wrap items-center justify-center"},[Ue("img",{class:"w-20px",src:nt},null),Ue("div",{class:"ml-4px mr-6px"},[l("Site.List.SmartCc")]),Ue(ot,null,{default:()=>[l("Site.List.SmartCcTips1"),Ue("br",null,null),l("Site.List.SmartCcTips2")]})]),render:e=>{var t,l,a,s;return Ue(et,{checked:(null==(l=null==(t=e.waf_info)?void 0:t.smart_cc)?void 0:l.open)&&(null==(s=null==(a=e.waf_info)?void 0:a.smart_cc)?void 0:s.open),onUpdateChecked:t=>{y(t,e)}},null)}},{key:"regional_restrictions_num",title:"禁中国境外",align:"center",width:"8%",minWidth:80,render:e=>Ue(dt,{size:"small",value:e.overseas.status,onUpdateValue:t=>{w(t,e)}},null)},{key:"cdn",align:"center",width:"8%",minWidth:110,title:()=>{let e;return Ue("div",{class:"flex flex-wrap items-center justify-center"},[Ue("div",{class:"mr-6px"},[l("Site.List.Cdn")]),Ue(ot,null,Xt(e=l("Site.List.CdnTips"))?e:{default:()=>[e]})])},render:e=>Ue(et,{checked:e.waf_info.cdn,onUpdateChecked:t=>{x(t,e)}},null)},{key:"action",title:l("Public.Table.Action"),width:"12%",minWidth:140,render:e=>{let t,a,s;return Ue("div",{class:"action"},[Ue(S,{onClick:()=>{m(e)}},Xt(t=l("Site.List.Config"))?t:{default:()=>[t]}),Ue(S,{onClick:()=>{_(e)}},Xt(a=l("Site.List.Logs"))?a:{default:()=>[a]}),Ue(S,{onClick:()=>{b(e)}},Xt(s=l("Public.Btn.Del"))?s:{default:()=>[s]})])}}]),v=M(),m=e=>{v.goDetails(e)},_=e=>{v.goDetails(e,"logs")},h=e=>{o(e)},y=(e,t)=>{const a=l(e?"Site.List.SetSmartCc.Content1":"Site.List.SetSmartCc.Content2");c({title:l("Site.List.SetSmartCc.Title",{status:l(e?"Public.Confirm.Enable":"Public.Confirm.Disable"),name:t.site_name}),content:a,onConfirm:async()=>{try{await T({site_id:t.site_id,open:e}),s()}catch(a){at(l("Site.List.SmartCc"),a)}}})},x=(e,t)=>{c({title:l("Site.List.SetCdn.Title",{status:l(e?"Public.Confirm.Enable":"Public.Confirm.Disable"),name:t.site_name}),content:l("Site.List.SetCdn.Content",{status:l(e?"Site.List.SetCdn.Used":"Site.List.SetCdn.NotUsed")}),onConfirm:async()=>{await P({site_id:t.site_id,cdn:e,cdn_baidu:!0,type:"site"}),s()}})},w=async(e,t)=>{e?(await st({site_ids:[t.site_id],type:"refuse",region:["海外"],add_type:"site_city",uri:""}),s()):(await it({region_id:[t.overseas.region_id]}),s())},b=e=>{c({title:l("Site.List.DelSite.Title",{name:e.site_name}),content:l("Site.List.DelSite.Content"),onConfirm:async()=>{await L({site_id:e.site_id}),s()}})},g=()=>{u.data.data=n.value.data,u.data.key=n.value.key,u.show=!0};return(e,l)=>{const a=lt,s=f,o=U,r=t;return Me(),Ee(r,null,{content:$e((()=>[Ue(a,{"checked-row-keys":Ce(n).key,"onUpdate:checkedRowKeys":l[0]||(l[0]=e=>Ce(n).key=e),"row-key":e=>e.site_id,loading:Ce(i),data:Ce(n).data,columns:Ce(p)},null,8,["checked-row-keys","row-key","loading","data","columns"])])),pageLeft:$e((()=>[Ke(Ue(s,{disabled:0===Ce(n).key.length,onClick:g},{default:$e((()=>[Ae("批量证书续签")])),_:1},8,["disabled"]),[[He,!0]])])),modal:$e((()=>[Ue(o,{show:Ce(u).show,"onUpdate:show":l[1]||(l[1]=e=>Ce(u).show=e),data:Ce(u).data,title:"批量操作",component:Ot},null,8,["show","data"])])),_:1})}}}),Qt=he({props:{keys:{type:String,default:""},pem:{type:String,default:""},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(e){const{t:t}=ge(),l=Ve(e,"keys"),a=Ve(e,"pem");return{tablekeys:ke([]),columns:ke([{type:"selection",multiple:!1,width:32},{key:"Domain",title:t("Site.SslModal.List.Domain"),width:140,render:e=>{var t;return Ue(Ne,null,[null==(t=e.Domains)?void 0:t.map((e=>Ue("p",null,[e])))])}},{key:"not_after",title:t("Site.SslModal.List.NotAfter"),width:90,render:e=>$(new Date(e.not_after),"yyyy-MM-dd")},{key:"brand",title:t("Site.SslModal.List.Brand")}]),onUpdate:(e,t)=>{const s=t[0];l.value=s.privkey,a.value=s.fullchain}}},render(){return Ue(ct,{"checked-row-keys":this.tablekeys,"onUpdate:checked-row-keys":[e=>this.tablekeys=e,this.onUpdate],"row-key":e=>e.ssl_name,"max-height":300,data:this.data,loading:this.loading,columns:this.columns},null)}}),Jt=he({props:{keys:{type:String,default:""},pem:{type:String,default:""}},setup:e=>({keyRef:Ve(e,"keys"),pemRef:Ve(e,"pem")}),render(){const{t:e}=ge();return Ue("div",{class:"flex"},[Ue("div",{class:"flex-1"},[Ue("div",{class:"mb-6px"},[e("Site.SslModal.Key")]),Ue(ut,{value:this.keyRef,"onUpdate:value":e=>this.keyRef=e,rows:5},null)]),Ue("div",{class:"flex-1 ml-12px"},[Ue("div",{class:"mb-6px"},[e("Site.SslModal.Pem")]),Ue(ut,{value:this.pemRef,"onUpdate:value":e=>this.pemRef=e,rows:5},null)])])}}),Zt=({onUpdateValue:e})=>{const{t:t}=ge();return Ue(Ne,null,[Ue(ft,{action:"",max:1,"default-upload":!1,"directory-dnd":!0,onBeforeUpload:async({file:t})=>{const l=new FileReader;l.addEventListener("load",(t=>{var l;const a=null==(l=t.target)?void 0:l.result,s=A(a)?a:"";e(s)})),l.readAsText(t.file)},onRemove:()=>{e("")}},{default:()=>[Ue(_t,null,{default:()=>[Ue("div",{class:"mb-8px"},[Ue(b,{name:"upload",size:"26",color:"#666666"},null)]),Ue(Tt,null,{default:()=>[t("Site.AddModal.Cert.UploadTips1"),Ue("br",null,null),t("Site.AddModal.Cert.UploadTips2")]})]})]})])},Yt=he({props:{keys:{type:String,default:""},pem:{type:String,default:""}},setup:e=>({keyRef:Ve(e,"keys"),pemRef:Ve(e,"pem")}),render(){const{t:e}=ge();return Ue("div",{class:"flex"},[Ue("div",{class:"flex-1"},[Ue("div",{class:"mb-6px"},[e("Site.SslModal.Key")]),Ue(Zt,{onUpdateValue:e=>{this.keyRef=e}},null)]),Ue("div",{class:"flex-1 ml-12px"},[Ue("div",{class:"mb-6px"},[e("Site.SslModal.Pem")]),Ue(Zt,{onUpdateValue:e=>{this.pemRef=e}},null)])])}});function el(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!qe(e)}const tl=he({props:{type:{type:Number,default:0},keys:{type:String,default:""},pem:{type:String,default:""}},emits:["update:keys","update:pem","update:type"],setup(e,{emit:t}){const{t:l}=ge(),a=Ve(e,"type"),s=Ve(e,"keys"),i=Ve(e,"pem"),n=ke([]),o=e=>{a.value=e},{loading:r,setLoading:d}=R(),u=async()=>{try{d(!0);const{res:e}=await D();n.value=B(e)?e:[]}finally{d(!1)}};return{typeRef:a,keyRef:s,pemRef:i,loading:r,certList:n,cutSsl:async()=>{o(1),await u(),0===n.value.length&&o(2)},cutNotSsl:()=>{o(0)},onUpdateType:e=>{1===e&&u(),t("update:type",e)},getErrorInfo:()=>1===a.value?l("Site.AddModal.Cert.ErrMsg1"):2===a.value?l("Site.AddModal.Cert.ErrMsg2"):3===a.value?l("Site.AddModal.Cert.ErrMsg3"):""}},render(){let e,t,l,a;const{t:s}=ge();return Ue("div",{class:"flex-1"},[Ue("div",{class:"flex items-center h-32px"},[Ue(pt,{value:this.typeRef,"onUpdate:value":e=>this.typeRef=e,onUpdateValue:this.onUpdateType},{default:()=>[Ue(vt,{class:"mr-8px",value:0},el(e=s("Site.AddModal.Cert.Radio0"))?e:{default:()=>[e]}),Ue(vt,{class:"mr-8px",value:1},el(t=s("Site.AddModal.Cert.Radio1"))?t:{default:()=>[t]}),Ue(vt,{class:"mr-8px",value:2},el(l=s("Site.AddModal.Cert.Radio2"))?l:{default:()=>[l]}),Ue(vt,{class:"mr-8px",value:3},el(a=s("Site.AddModal.Cert.Radio3"))?a:{default:()=>[a]})]})]),Ue(ht,{class:"w-420px mt-12px",show:0!==this.typeRef},{default:()=>[Ue("div",{class:"mb-12px text-desc"},[s("Site.AddModal.Cert.Tips")]),Ke(Ue(Qt,{keys:this.keyRef,"onUpdate:keys":e=>this.keyRef=e,pem:this.pemRef,"onUpdate:pem":e=>this.pemRef=e,data:this.certList,loading:this.loading},null),[[He,1===this.typeRef]]),Ke(Ue(Jt,{keys:this.keyRef,"onUpdate:keys":e=>this.keyRef=e,pem:this.pemRef,"onUpdate:pem":e=>this.pemRef=e},null),[[He,2===this.typeRef]]),Ke(Ue(Yt,{keys:this.keyRef,"onUpdate:keys":e=>this.keyRef=e,pem:this.pemRef,"onUpdate:pem":e=>this.pemRef=e},null),[[He,3===this.typeRef]])]})])}}),ll={key:0,class:"text-desc"},al={key:1,class:"text-desc"},sl=he({__name:"content",props:{test:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},setup:e=>(t,l)=>e.loading?(Me(),Te("span",ll,Le(t.$t("Site.AddModal.TestSource.Testing")),1)):e.test?Ie(t.$slots,"default",{key:2}):(Me(),Te("span",al,Le(t.$t("Site.AddModal.TestSource.NotTest")),1))}),il={class:"detect-result"},nl={class:"rows"},ol={class:"label"},rl={class:"value"},dl={class:"text-warning font-bold"},ul={key:1},cl={class:"text-warning font-bold"},pl={class:"rows"},vl={class:"label"},ml={class:"value"},fl={class:"rows"},_l={class:"label"},hl={class:"value"},yl={class:"text-warning font-bold"},xl=_(he({__name:"index",props:{test:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},result:{default:()=>({})}},setup(e){const t=e,l=ye((()=>{const{result:e}=t,{source_ip_list:l}=e,{extranet_ip_list:a,intranet_ip_list:s}=l||{};return(null==s?void 0:s[0])||(null==a?void 0:a[0])||""}));return(e,t)=>{const a=Oe("i18n-t"),s=j,i=z;return Me(),Ee(i,{show:e.loading},{default:$e((()=>[Ue(s,{type:"success",class:"w-414px","show-icon":!1},{default:$e((()=>[Pe("div",il,[Pe("div",nl,[Pe("div",ol,Le(e.$t("Site.AddModal.TestSource.IP"))+" "+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",rl,[Ue(sl,{test:e.test,loading:e.loading},{default:$e((()=>[e.result.is_cdn?(Me(),Ee(a,{key:0,tag:"span",keypath:"Site.AddModal.TestSource.IpResult1"},{action:$e((()=>[Pe("span",dl,Le(e.$t("Site.AddModal.TestSource.Manual")),1)])),_:1})):Ce(l)?(Me(),Te("span",ul,Le(Ce(l)),1)):(Me(),Ee(a,{key:2,tag:"span",keypath:"Site.AddModal.TestSource.IpResult2"},{action:$e((()=>[Pe("span",cl,Le(e.$t("Site.AddModal.TestSource.Manual")),1)])),_:1}))])),_:1},8,["test","loading"])])]),Pe("div",pl,[Pe("div",vl,Le(e.$t("Site.AddModal.TestSource.Https"))+" "+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",ml,[Ue(sl,{test:e.test,loading:e.loading},{default:$e((()=>[Ae(Le(e.result.is_force_https?e.$t("Site.AddModal.TestSource.Force"):e.$t("Site.AddModal.TestSource.NotForce")),1)])),_:1},8,["test","loading"])])]),Re("",!0),Pe("div",fl,[Pe("div",_l,Le(e.$t("Site.AddModal.TestSource.Recommend"))+" "+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",hl,[Ue(sl,{test:e.test,loading:e.loading},{default:$e((()=>[Pe("div",yl,Le(e.$t("Site.AddModal.TestSource.RecommendReulst",{type:e.result.is_force_https?"HTTPS":"HTTP",method:e.result.is_https||e.result.is_force_https?e.$t("Site.AddModal.TestSource.RecommendMethod1"):e.$t("Site.AddModal.TestSource.RecommendMethod2")})),1)])),_:1},8,["test","loading"])])])])])),_:1})])),_:1},8,["show"])}}}),[["__scopeId","data-v-e3387a9b"]]),Sl={key:0,class:"pt-2px"},wl={key:0,class:"flex"},bl={class:"ml-8px"},gl={key:2,class:"text-primary"},kl={key:1},Cl=[(e=>(je("data-v-2ab7ebe6"),e=e(),ze(),e))((()=>Pe("span",{class:"text-desc pl-80px"},"*支持使用域名作为回源地址",-1)))],Ml=_(he({__name:"feedback",props:{status:{default:"none"},text:{default:""}},setup(e){const t=e,{t:l}=ge(),a=ye((()=>{const{text:e}=t;return""===e?[l("Site.AddModal.SourceTestLoading")]:e.split("；")}));return(e,t)=>{const l=z;return"none"!==e.status?(Me(),Te("div",Sl,["loading"===e.status?(Me(),Te("div",wl,[Ue(l,{class:"source-loading",stroke:"#999"}),Pe("span",bl,Le(e.$t("Site.AddModal.SourceTestLoading")),1)])):"error"===e.status?(Me(!0),Te(Ne,{key:1},Xe(Ce(a),(e=>(Me(),Te("p",{key:e,class:"text-error"},Le(e),1)))),128)):"success"===e.status?(Me(),Te("span",gl,Le(e.text),1)):Re("",!0)])):(Me(),Te("div",kl,Cl))}}}),[["__scopeId","data-v-2ab7ebe6"]]),Tl=he({props:{value:{type:Array,default:()=>[]}},emits:["update:value","changeSsl"],setup(e,{emit:t}){const l=Ve(e,"value"),a=()=>{l.value.push({port:null,ssl:!1})},s=()=>{t("changeSsl")};return 0===l.value.length&&a(),{portList:l,addPort:a,delPort:e=>{l.value.splice(e,1)},onUpdatePort:(e,t)=>{443===e&&(t.ssl=!0,s())},onUpdateChecked:s}},render(){const{portList:e}=this;return Ue(Ne,null,[e.map(((t,l)=>Ue(I,{path:"port[".concat(l,"].port"),rule:{trigger:["input","blur"],validator(){if(null===t.port)return new Error("请输入端口");if(t.port<1||t.port>65535)return new Error("端口范围为1-65535");return!(e.map((e=>e.port)).filter((e=>e===t.port)).length>1)||new Error("端口不能重复")}}},{default:()=>[Ue("div",{class:"w-240px"},[Ue(yt,{value:t.port,showButton:!1,placeholder:"请输入端口",onUpdateValue:e=>{t.port=e,this.onUpdatePort(e,t)}},null)]),Ue("div",{class:"ml-24px"},[Ue(et,{checked:t.ssl,disabled:80===t.port,onUpdateChecked:e=>{t.ssl=e,this.onUpdateChecked()}},{default:()=>[Ae("SSL")]})]),Ue("div",{class:"ml-16px"},[Ue(S,{disabled:1===e.length,onClick:()=>{this.delPort(l)}},{default:()=>[Ae("删除")]})])]}))),Ue("div",null,[Ue(f,{color:"#F5FAF2",class:"w-360px",onClick:()=>{this.addPort()}},{default:()=>[Ue(b,{name:"add",size:"22",color:"#20A53A"},null),Ue("span",{class:"ml-2px text-primary"},[Ae("添加端口")])]})])])}}),Pl=he({props:{ssl:{type:Number,default:0},value:{type:Array,default:()=>[]}},emits:["update:type","update:value","changeSsl"],setup(e,{emit:t}){const l=ke(1),a=Ve(e,"value");return{type:l,valueRef:a,changeSsl:()=>{t("changeSsl")},onUpdateType:e=>{l.value=e,a.value=[],t("update:type",e)}}},render(){return Ue("div",{class:"flex-1"},[Ue("div",{class:"flex items-center h-32px"},[Ue(pt,{value:this.type,onUpdateValue:this.onUpdateType},{default:()=>[Ue(vt,{class:"mr-8px",value:1},{default:()=>[Ae("常用("),this.ssl?"80, 443":80,Ae(")")]}),Ue(vt,{class:"mr-8px",value:2},{default:()=>[Ae("自定义")]})]})]),Ue(ht,{class:"mt-12px",show:2===this.type},{default:()=>[Ue(Tl,{value:this.valueRef,"onUpdate:value":e=>this.valueRef=e,onChangeSsl:this.changeSsl},null)]})])}}),Ll={class:"w-600px"},Ul={class:"min-h-480px p-24px pb-8px"},$l={class:"flex items-center"},Al={class:"w-330px mr-8px"},Rl={class:"flex items-center"},Dl={class:"mr-6px"},Bl={class:"leading-20px"},jl={class:"w-240px"},zl={class:"flex items-center"},Il={class:"w-68px mr-8px"},Wl={class:"flex-1"},Nl={class:"text-desc ml-12px"},Fl={class:"w-240px"},El={class:"ml-12px text-desc"},Kl={class:"w-240px"},ql={class:"footer-btn"},Hl={class:"p-8px"},Vl={class:"flex flex-center mb-12px"},Ol={class:"ml-8px text-15px"},Xl={class:"text-13px"},Gl=_(he({__name:"index",emits:["close"],setup(e,{emit:t}){const{t:l}=ge(),a=W(),s=ke([{label:"http",value:"http"},{label:"https",value:"https"}]),i=k(),{getList:n}=i,o=ke([]),r=ke(!1),d=Fe({site_id:"",domain:"",is_cdn:0,load_group_id:null,site_name:"",status:1,server:{listen_ipv6:1,listen_port:["80"],listen_ssl_port:["443"],ssl:{is_ssl:0,private_key:"",full_chain:"",force_https:0},upstream:{polling_algorithm:"ip_hash",host:"$host_optimize",source_protocol:"http",server:[{address:""}]}}}),u={domain:{required:!0,message:l("Site.AddModal.DomainMsg"),trigger:["blur","input"]},ip_list:{required:!0,trigger:["input"],validator:()=>""===d.server.upstream.server[0].address||void 0===d.server.upstream.server[0].address?(M.status="error",M.text=l("Site.AddModal.SourceMsg"),new Error(l("Site.AddModal.SourceMsg"))):(M.status="success",M.text="",!0)},ssl:{required:!0,validator:()=>{if(d.server.ssl.is_ssl&&(""===d.server.ssl.full_chain||""===d.server.ssl.private_key)){const e=_.value.getErrorInfo();return new Error(e)}return!0}}},p=Ge(null),v=Ge(null),m=Ge(null),_=Ge(),h=Ge(null),y=Fe({loading:!1,isTest:!1,result:{}}),x=async(e="")=>{var t;try{await(null==(t=v.value)?void 0:t.validate()),y.isTest=!0,y.loading=!0,T();const{res:l}=await N({domains:d.domain.trim().split("\n")});if(B(l)&&l.length>0){const t=l[0];y.result=t,d.is_cdn=t.is_cdn?1:0,r.value=t.is_force_https,d.is_cdn||""!==e||(d.server.upstream.server[0].address=t.source_ip_list.intranet_ip_list.length>0?t.source_ip_list.intranet_ip_list[0]:t.source_ip_list.extranet_ip_list[0])}}finally{y.loading=!1}},S=ke(!1),w=e=>{y.isTest=!1,r.value=!1,e?(d.site_name="*"===e?"通配所有域名":e.trim().split("\n").filter((e=>""!==e))[0]||"",S.value="*"===e):d.site_name=""},g=e=>{var t;null==(t=m.value)||t.restoreValidation(),0===e?(d.server.ssl.private_key="",d.server.ssl.full_chain="",d.server.listen_port=["80"],d.server.listen_ssl_port=[]):(d.server.listen_port=["80"],d.server.listen_ssl_port=["443"]),d.server.ssl.is_ssl=0===e?0:1},C=()=>"".concat(r.value?"https":"http","://").concat(d.server.upstream.server[0].address),M=Fe({status:"none",text:""}),T=()=>{M.status="none",M.text=""},P=async()=>{var e,t;if("loading"!==M.status&&(y.isTest||await x(d.server.upstream.server[0].address),""!==d.domain&&!y.result.is_cdn&&(0!==(null==(e=y.result.source_ip_list)?void 0:e.extranet_ip_list.length)||0!==(null==(t=y.result.source_ip_list)?void 0:t.intranet_ip_list.length))&&""!==d.server.upstream.server[0].address&&void 0!==d.server.upstream.server[0].address))try{M.status="loading",M.text="";const e=C(),t=y.result;await F({url:e,is_ssl:1===d.server.ssl.is_ssl,is_force_https:t.is_force_https,is_ssl_check:r.value,http_protocol:r.value?"https":"http",extranet_ip_list:t.is_cdn?[]:t.source_ip_list.extranet_ip_list,intranet_ip_list:t.is_cdn?[]:t.source_ip_list.intranet_ip_list}),M.status="success",M.text=l("Site.AddModal.SourceTestSucess")}catch(a){const{res:e}=a;M.status="error",M.text=e.error}},L=e=>{r.value="https"===e,P()},$=()=>{t("close")},A=ke(0),R=e=>{1===e?0===A.value?(d.server.listen_port=["80"],d.server.listen_ssl_port=[]):(d.server.listen_port=["80"],d.server.listen_ssl_port=["443"]):(d.server.listen_port=[],d.server.listen_ssl_port=[])},D=()=>{var e,t;o.value.filter((e=>e.ssl)).length>0?(d.server.ssl.is_ssl=1,null==(e=_.value)||e.cutSsl()):(d.server.ssl.is_ssl=0,null==(t=_.value)||t.cutNotSsl())},j=()=>{const e=Qe(d),{ports:t,sslPorts:l}=(()=>{const e=[],t=[];return o.value.forEach((l=>{null!==l.port&&(l.ssl?t.push(l.port.toString()):e.push(l.port.toString()))})),{ports:e,sslPorts:t}})();return o.value.length>0&&(e.server.listen_port=t,e.server.listen_ssl_port=l),0===A.value&&(e.server.listen_ssl_port=[]),{...d,load_group_id:e.load_group_id||0,domain_list:e.domain.trim().split("\n").filter((e=>e.trim())),ip_list:[C()]}},z=async()=>{var e;await(null==(e=p.value)?void 0:e.validate()),y.isTest&&"success"!==M.status&&"none"!==M.status?c({title:l("Public.Confirm.Title"),content:"loading"===M.status?l("Site.AddModal.TestConfirm.Content"):M.text,cancelTitle:l("Site.AddModal.TestConfirm.CancelBtn"),confirmTitle:l("Site.AddModal.TestConfirm.ConfirmBtn"),onConfirm:async()=>{await O(),$()}}):(await O(),$())},V=ke(!1),O=async()=>{const e=j();await E(e),n()};return(e,t)=>{const l=ut,i=f,n=I,r=ot,c=mt,k=K,C=q,T=H,B=b,j=U;return Me(),Te("div",Ll,[Ue(T,{class:"max-h-535px"},{default:$e((()=>[Pe("div",Ul,[Ue(C,{ref_key:"formRef",ref:p,model:Ce(d),rules:u,"label-width":"102","label-placement":"left","require-mark-placement":"left"},{default:$e((()=>[Ue(n,{ref_key:"domainItemRef",ref:v,label:e.$t("Site.AddModal.Domain"),path:"domain"},{default:$e((()=>[Pe("div",$l,[Pe("div",Al,[Ue(l,{value:Ce(d).domain,"onUpdate:value":[t[0]||(t[0]=e=>Ce(d).domain=e),w]},{default:$e((()=>[Pe("p",null,Le(e.$t("Site.AddModal.DomainPlace1")),1),Pe("p",null,Le(e.$t("Site.AddModal.DomainPlace2")),1),Pe("p",null,Le(e.$t("Site.AddModal.DomainPlace4")),1)])),_:1},8,["value"])]),Ue(i,{disabled:Ce(y).loading,onClick:t[1]||(t[1]=e=>x())},{default:$e((()=>[Pe("span",null,Le(e.$t("Site.AddModal.TestBtn")),1)])),_:1},8,["disabled"])])])),_:1},8,["label"]),Ue(n,{label:e.$t("Site.AddModal.TestResult")},{default:$e((()=>[Ue(xl,{test:Ce(y).isTest,loading:Ce(y).loading,result:Ce(y).result},null,8,["test","loading","result"])])),_:1},8,["label"]),Ue(n,{label:"端口"},{default:$e((()=>[Ue(Ce(Pl),{value:Ce(o),"onUpdate:value":t[2]||(t[2]=e=>Be(o)?o.value=e:null),ssl:Ce(d).server.ssl.is_ssl,"onUpdate:type":R,onChangeSsl:D},null,8,["value","ssl"])])),_:1}),Ue(n,{ref_key:"sslFormRef",ref:m,path:"ssl",label:e.$t("Site.AddModal.SslCert")},{default:$e((()=>[Ue(Ce(tl),{ref_key:"sslRef",ref:_,type:Ce(A),"onUpdate:type":[t[3]||(t[3]=e=>Be(A)?A.value=e:null),g],keys:Ce(d).server.ssl.private_key,"onUpdate:keys":t[4]||(t[4]=e=>Ce(d).server.ssl.private_key=e),pem:Ce(d).server.ssl.full_chain,"onUpdate:pem":t[5]||(t[5]=e=>Ce(d).server.ssl.full_chain=e)},null,8,["type","keys","pem"])])),_:1},8,["label"]),Ue(n,{ref_key:"sourceFormRef",ref:h,path:"ip_list"},{label:$e((()=>[Pe("div",Rl,[Pe("div",Dl,Le(e.$t("Site.AddModal.Source")),1),Ue(r,null,{default:$e((()=>[Pe("div",Bl,[Pe("p",null,Le(e.$t("Site.AddModal.SourceTips1")),1),Pe("p",null,Le(e.$t("Site.AddModal.SourceTips2")),1)])])),_:1})])])),feedback:$e((()=>[Ue(Ml,{status:Ce(M).status,text:Ce(M).text},null,8,["status","text"])])),default:$e((()=>[Pe("div",jl,[Pe("div",zl,[Pe("div",Il,[Ue(c,{value:Ce(d).server.upstream.source_protocol,"onUpdate:value":[t[6]||(t[6]=e=>Ce(d).server.upstream.source_protocol=e),L],options:Ce(s),"consistent-menu-width":!1},null,8,["value","options"])]),Pe("div",Wl,[Ue(k,{value:Ce(d).server.upstream.server[0].address,"onUpdate:value":t[7]||(t[7]=e=>Ce(d).server.upstream.server[0].address=e),spellcheck:"false",placeholder:e.$t("Site.AddModal.SourcePlace"),onBlur:P},null,8,["value","placeholder"])])])]),Pe("div",Nl,Le(e.$t("Site.AddModal.SourceTips3")),1)])),_:1},512),Ue(n,{class:"mt-4px",label:"CDN"},{default:$e((()=>[Pe("div",Fl,[Ue(c,{value:Ce(d).is_cdn,"onUpdate:value":t[8]||(t[8]=e=>Ce(d).is_cdn=e),options:[{label:e.$t("Site.AddModal.Unused"),value:0},{label:e.$t("Site.AddModal.Used"),value:1}]},null,8,["value","options"])]),Pe("div",El,Le(e.$t("Site.AddModal.CdnTips",{status:Ce(y).result.is_cdn?e.$t("Site.AddModal.Used"):e.$t("Site.AddModal.Unused")})),1)])),_:1}),Ue(n,{label:e.$t("Site.AddModal.SiteName")},{default:$e((()=>[Pe("div",Kl,[Ue(k,{value:Ce(d).site_name,"onUpdate:value":t[9]||(t[9]=e=>Ce(d).site_name=e),spellcheck:"false",disabled:Ce(S),placeholder:e.$t("Site.AddModal.SiteNamePlace")},null,8,["value","disabled","placeholder"])])])),_:1},8,["label"])])),_:1},8,["model"])])])),_:1}),Pe("div",ql,[Ue(i,{size:"small",class:"cancel-btn",color:"#cbcbcb",onClick:$},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Cancel")),1)])),_:1}),Ue(i,{type:"primary",size:"small",onClick:z},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Confirm")),1)])),_:1})]),Ue(j,{show:Ce(V),"onUpdate:show":t[10]||(t[10]=e=>Be(V)?V.value=e:null),onPublicClose:$},{default:$e((()=>[Pe("div",Hl,[Pe("div",Vl,[Ue(B,{name:"success",size:"24",color:Ce(a).successColor},null,8,["color"]),Pe("span",Ol,Le(e.$t("Site.AddModal.AddSuccessTitle")),1)]),Pe("div",Xl,Le(e.$t("Site.AddModal.AddSuccessContent")),1)])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-48aa9974"]]),Ql=Symbol("server-list");const Jl=e=>(je("data-v-d46a285a"),e=e(),ze(),e),Zl={class:"info"},Yl={class:"rows"},ea={class:"cols"},ta={class:"label"},la={class:"value w-0"},aa={class:"cols"},sa={class:"label"},ia={class:"value w-0"},na={class:"rows"},oa={class:"cols"},ra={class:"label"},da={class:"value flex items-center"},ua={class:"cols"},ca={class:"label"},pa={class:"value"},va={key:0,class:"text-primary"},ma={key:1,class:"text-error"},fa={class:"flex"},_a={class:"flex-1"},ha={class:"mb-5px"},ya={class:"flex-1 ml-16px"},xa={class:"mb-5px"},Sa={class:"mt-12px"},wa=Jl((()=>Pe("div",{class:"mb-5px"},"SSL端口",-1))),ba={class:"flex items-center"},ga={class:"w-240px"},ka=Jl((()=>Pe("div",{class:"ml-12px text-desc"}," 使用HTTPS/WSS协议访问时所使用的端口，多个端口用英文下的逗号,分隔 ",-1))),Ca={class:"mt-10px"},Ma=_(he({__name:"index",setup(e){const{row:t}=we("component-data"),{t:l}=ge(),a=k(),{getList:s,setSsl:i}=a,{info:n,listenPort:o}=we(Ql),r=ye((()=>n.value.not_after?V(new Date(n.value.not_after),"yyyy-MM-dd"):"--")),d=ye((()=>{if(n.value.not_after){const e=new Date(n.value.not_after);return O(e,new Date)}return 0})),u=ke(!1),p=async e=>{e?(await X({site_id:t.site_id,force_https:!0}),s()):c({title:l("Site.SslModal.Current.SetForce.Title"),content:l("Site.SslModal.Current.SetForce.Content"),onConfirm:async()=>{await X({site_id:t.site_id,force_https:!1}),s()},onPublicCancel:()=>{u.value=!e}})},v=Fe({port:"443",private_key:"",full_chain:""});Je((()=>{B(o.value)&&(o.value.some((e=>/^\d+$/.test(e)))?v.port=o.value.join(",")||"":v.port="443"),v.private_key=n.value.private_key||"",v.full_chain=n.value.full_chain||"",u.value=1===n.value.force_https}));const m=()=>{if(!v.port)return void G("请输入SSL端口");v.port.split(",").includes("80")?G("SSL端口不能包含80端口"):v.full_chain&&v.private_key?h():G(l("Site.SslModal.Current.SaveSsl.ErrorMsg"))},_=async()=>{v.private_key&&v.full_chain?v.private_key!==n.value.private_key||v.full_chain!==n.value.full_chain?c({title:l("Site.SslModal.Current.SaveSsl.Title"),content:l("Site.SslModal.Current.SaveSsl.Content"),onConfirm:async()=>{h()}}):h():G(l("Site.SslModal.Current.SaveSsl.ErrorMsg"))},h=async()=>{const e=v.port.split(",");await Q({site_id:t.site_id,...Qe(v),port:e}),await s(),i()},y=()=>{J({site_id:t.site_id})},x=async()=>{await Z({site_id:t.site_id}),await s(),i()};return(e,t)=>{const l=Y,a=dt,s=j,i=ut,o=K,u=f,c=S,h=wt;return Me(),Te("div",null,[1===Ce(n).is_ssl?(Me(),Ee(s,{key:0,class:"mb-12px",type:"success","show-icon":!1},{default:$e((()=>[Pe("div",Zl,[Pe("div",Yl,[Pe("div",ea,[Pe("div",ta,Le(e.$t("Site.SslModal.Domain"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",la,[Ue(l,null,{default:$e((()=>{var t;return[Ae(Le((null==(t=Ce(n).Domains)?void 0:t.join(e.$t("Public.Punctuation.Comma")))||"--"),1)]})),_:1})])]),Pe("div",aa,[Pe("div",sa,Le(e.$t("Site.SslModal.Brand"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",ia,[Ue(l,null,{default:$e((()=>[Ae(Le(Ce(n).brand||"--"),1)])),_:1})])])]),Pe("div",na,[Pe("div",oa,[Pe("div",ra,Le(e.$t("Site.SslModal.ForceHTTPS"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",da,[Ue(a,{value:Ce(n).force_https,"onUpdate:value":[t[0]||(t[0]=e=>Ce(n).force_https=e),p],size:"small"},null,8,["value"])])]),Pe("div",ua,[Pe("div",ca,Le(e.$t("Site.SslModal.NotAfter"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",pa,[Ce(d)>0?(Me(),Te("span",va,Le(e.$t("Site.SslModal.Current.Unexpired",{expireTime:Ce(r),expireDay:Ce(d)})),1)):(Me(),Te("span",ma,Le(e.$t("Site.SslModal.Current.Expired")),1))])])])])])),_:1})):Re("",!0),Pe("div",fa,[Pe("div",_a,[Pe("div",ha,Le(e.$t("Site.SslModal.Key")),1),Ue(i,{value:Ce(v).private_key,"onUpdate:value":t[1]||(t[1]=e=>Ce(v).private_key=e),rows:10},null,8,["value"])]),Pe("div",ya,[Pe("div",xa,Le(e.$t("Site.SslModal.Pem")),1),Ue(i,{value:Ce(v).full_chain,"onUpdate:value":t[2]||(t[2]=e=>Ce(v).full_chain=e),rows:10},null,8,["value"])])]),Pe("div",Sa,[wa,Pe("div",ba,[Pe("div",ga,[Ue(o,{value:Ce(v).port,"onUpdate:value":t[3]||(t[3]=e=>Ce(v).port=e),placeholder:"请输入SSL端口"},null,8,["value"])]),ka])]),Pe("div",Ca,[1===Ce(n).is_ssl?(Me(),Ee(u,{key:0,type:"primary",onClick:_},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Save")),1)])),_:1})):(Me(),Ee(u,{key:1,type:"primary",onClick:m},{default:$e((()=>[Ae(Le(e.$t("Site.SslModal.Current.SaveBtn")),1)])),_:1})),Ce(n).private_key||Ce(n).full_chain?(Me(),Ee(u,{key:2,class:"ml-10px",onClick:y},{default:$e((()=>[Ae(Le(e.$t("Site.SslModal.Current.Download")),1)])),_:1})):Re("",!0),1===Ce(n).is_ssl?(Me(),Ee(u,{key:3,class:"ml-10px",onClick:x},{default:$e((()=>[Ae(Le(e.$t("Site.SslModal.Current.CloseBtn")),1)])),_:1})):Re("",!0)]),Ue(h,{class:"mt-16px"},{default:$e((()=>[Pe("li",null,[Pe("span",null,Le(e.$t("Site.SslModal.Current.Tips1")),1),Ue(c,{href:"http://www.bt.cn/bbs/thread-704-1-1.html",target:"_blank"},{default:$e((()=>[Ae(" ["+Le(e.$t("Public.Help"))+"] ",1)])),_:1})]),Pe("li",null,Le(e.$t("Site.SslModal.Current.Tips2")),1),Pe("li",null,Le(e.$t("Site.SslModal.Current.Tips3")),1),Pe("li",null,Le(e.$t("Site.SslModal.Current.Tips4")),1),Pe("li",null,Le(e.$t("Site.SslModal.Current.Tips5")),1)])),_:1})])}}}),[["__scopeId","data-v-d46a285a"]]),Ta={class:"w-490px"},Pa={class:"px-32px py-16px leading-22px rounded-4px bg-[#f5faf2] text-[#666]"},La={class:"rows"},Ua={class:"label"},$a={class:"value"},Aa={class:"rows"},Ra={class:"label"},Da={class:"value"},Ba={class:"rows"},ja={class:"label"},za={class:"value"},Ia={class:"mt-16px"},Wa={class:"pl-5px mb-5px text-[#666]"},Na={class:"site-box"},Fa={class:"flex justify-between"},Ea=_(he({__name:"deploy",setup(e,{expose:t}){const{siteId:l,row:a}=we("component-data"),{getInfo:s}=we(Ql),{t:i}=ge(),n=k(),{getList:o,setSsl:r}=n,d=ye((()=>a.not_after?V(new Date(a.not_after),"yyyy-MM-dd"):"--")),u=ke(""),c=ke([l]),p=ke([]),v=ke([]),m=()=>{c.value=p.value.map((e=>A(e.key)?e.key:""))},_=()=>{c.value=[]},h=e=>{""!==e?(p.value=[],v.value.forEach((t=>{(c.value.includes(t.key)||A(t.label)&&t.label.includes(e))&&p.value.push(t)}))):p.value=v.value};return t({onConfirm:async e=>{await te({site_ids:c.value,ssl_name:a.ssl_name,private_key:a.privkey,full_chain:a.fullchain}),await(null==s?void 0:s()),await o(),r(),e()}}),(async()=>{const{res:e}=await ee(),{list:t}=e;p.value=[],B(t)?t.forEach((e=>{e.site_id===l?p.value.unshift({label:"".concat(e.site_name," [").concat(i("Public.SiteCheckbox.CurSite"),"]"),key:e.site_id}):p.value.push({label:e.site_name||"--",key:e.site_id})})):p.value=[],v.value=p.value})(),(e,t)=>{var l;const s=f,i=_e,n=le,o=xt,r=H;return Me(),Te("div",Ta,[Pe("div",Pa,[Pe("div",La,[Pe("div",Ua,Le(e.$t("Site.SslModal.Domain"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",$a,Le((null==(l=Ce(a).Domains)?void 0:l.join(e.$t("Public.Punctuation.Comma")))||"--"),1)]),Pe("div",Aa,[Pe("div",Ra,Le(e.$t("Site.SslModal.Brand"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",Da,Le(Ce(a).brand||"--"),1)]),Pe("div",Ba,[Pe("div",ja,Le(e.$t("Site.SslModal.NotAfter"))+Le(e.$t("Public.Punctuation.Colon")),1),Pe("div",za,Le(Ce(d)),1)])]),Pe("div",Ia,[Pe("div",Wa,Le(e.$t("Site.SslModal.List.SelectSiteDesc")),1),Pe("div",Na,[Pe("div",Fa,[Pe("div",null,[Ue(s,{onClick:m},{default:$e((()=>[Ae(Le(e.$t("Public.SiteCheckbox.All")),1)])),_:1}),Ue(s,{class:"ml-8px",onClick:_},{default:$e((()=>[Ae(Le(e.$t("Public.SiteCheckbox.NotAll")),1)])),_:1})]),Pe("div",null,[Ue(i,{value:Ce(u),"onUpdate:value":[t[0]||(t[0]=e=>Be(u)?u.value=e:null),h],prefix:!0,width:200,placeholder:e.$t("Public.SiteCheckbox.Search")},null,8,["value","placeholder"])])]),Ue(n,{class:"!my-12px"}),Ue(r,{class:"max-h-280px"},{default:$e((()=>[Ue(o,{"checked-keys":Ce(c),"onUpdate:checkedKeys":t[1]||(t[1]=e=>Be(c)?c.value=e:null),checkable:"","block-line":"","check-on-click":"",data:Ce(p)},null,8,["checked-keys","data"])])),_:1})])])])}}}),[["__scopeId","data-v-d3fdf797"]]);function Ka(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!qe(e)}const qa=he({__name:"index",setup(e){const{row:l}=we("component-data"),{t:a}=ge(),s=Fe({data:[]}),{loading:i,setLoading:n}=R(),o=async()=>{try{n(!0);const{res:e}=await D();B(e)?s.data=e:s.data=[]}finally{n(!1)}},r=ke([{key:"Domain",title:a("Site.SslModal.List.Domain"),width:130,render:e=>{var t;return Ue(Ne,null,[null==(t=e.Domains)?void 0:t.map((e=>Ue("div",null,[e])))])}},{key:"not_after",title:a("Site.SslModal.List.NotAfter"),width:90,render:e=>V(new Date(e.not_after),"yyyy-MM-dd")},{key:"brand",title:a("Site.SslModal.List.Brand")},{key:"action",title:a("Public.Table.Action"),width:80,render:e=>{let t,l;return Ue(Ne,null,[Ue(S,{class:"mr-10px",onClick:()=>{u(e)}},Ka(t=a("Site.SslModal.List.Deploy"))?t:{default:()=>[t]}),Ue(S,{onClick:()=>{p(e)}},Ka(l=a("Public.Btn.Del"))?l:{default:()=>[l]})])}}]),d=Fe({show:!1,title:a("Site.SslModal.List.DeployTitle"),data:{siteId:l.site_id,row:{}}}),u=e=>{d.data.row=e,d.show=!0},p=e=>{c({title:a("Site.SslModal.List.DelTitle",{name:e.ssl_name}),content:a("Site.SslModal.List.DelContent"),onConfirm:async()=>{await ae({ssl_name:e.ssl_name}),o()}})};return o(),(e,l)=>{const a=ct,n=U,o=t;return Me(),Ee(o,null,{content:$e((()=>[Ue(a,{loading:Ce(i),data:Ce(s).data,columns:Ce(r)},null,8,["loading","data","columns"])])),modal:$e((()=>[Ue(n,{show:Ce(d).show,"onUpdate:show":l[0]||(l[0]=e=>Ce(d).show=e),title:Ce(d).title,data:Ce(d).data,"is-footer":!0,component:Ea,"confirm-text":e.$t("Site.SslModal.List.Deploy")},null,8,["show","title","data","confirm-text"])])),_:1})}}}),Ha={class:"w-500px pr-20px"},Va=he({__name:"index",setup(e){const{key:t}=we("component-data"),l=Fe({key:"",secret:""}),a=new Map([["CloudXns",{title:"AccessKey",secret:"SecretKey",trip:"cloudxns后台》用户中心》API管理，按指引获取AccessKey/SecretKey"}],["aliyun",{title:"AccessKey",secret:"SecretKey",trip:"阿里云控制台》用户头像》accesskeys按指引获取AccessKey/SecretKey"}],["DnsPod",{title:"ID",secret:"Token",trip:"DnsPod后台》用户中心》安全设置，开启API Token"}],["CloudFlare",{title:"E-Mail",secret:"API Key",trip:"CloudFlare后台获取Global API Key"}]]);return(e,s)=>{const i=K,n=I,o=q,r=wt;return Me(),Te("div",Ha,[Ue(o,{model:Ce(l),"label-placement":"left","label-width":"100"},{default:$e((()=>{var e,o;return[Ue(n,{label:null==(e=Ce(a).get(Ce(t)))?void 0:e.title},{default:$e((()=>[Ue(i,{value:Ce(l).key,"onUpdate:value":s[0]||(s[0]=e=>Ce(l).key=e),placeholder:" "},null,8,["value"])])),_:1},8,["label"]),Ue(n,{label:null==(o=Ce(a).get(Ce(t)))?void 0:o.secret},{default:$e((()=>[Ue(i,{value:Ce(l).secret,"onUpdate:value":s[1]||(s[1]=e=>Ce(l).secret=e),placeholder:" "},null,8,["value"])])),_:1},8,["label"])]})),_:1},8,["model"]),Ue(r,{class:"mt-16px"},{default:$e((()=>{var e;return[Pe("li",null,Le(null==(e=Ce(a).get(Ce(t)))?void 0:e.trip),1)]})),_:1})])}}}),Oa={class:"w-700px"},Xa=Pe("p",{class:"mb-10px"},"请按以下列表做TXT解析:",-1),Ga=Pe("li",null,"解析域名需要一定时间来生效,完成所以上所有解析操作后,请等待1分钟后再点击验证按钮",-1),Qa={key:0},Ja=he({__name:"index",setup(e){const{getInfo:l}=we(Ql),a=k(),{menu:s}=be(a),{getList:i,setSsl:n}=a,{domain:o,types:r,siteId:d,cancelModal:u}=we("component-data"),c=Fe({data:[]}),p=ke(""),{loading:v,setLoading:m}=R(),_=async()=>{try{ne("正在验证TXT解析记录...");const e=await se({types:r,domain:o,site_id:d}),{res:t}=e;if("证书申请并部署到网站成功"===t)ie(t),s.value="current",u();else{const e=t.split("\n");c.data=e.map((e=>{const[t,l]=e.split(/\s+/);return{key:t,value:l}})),p.value=c.data.length>0?c.data[0].key:"",oe("验证未通过，请稍候重新验证")}}catch(e){e.res.includes("安装证书失败")&&(await(null==l?void 0:l()),await i(),n(),s.value="list",u())}},h=ke([{key:"key",title:"解析域名"},{key:"value",title:"记录值"},{key:"type",title:"类型",width:"8%",render:()=>"TXT"},{key:"must",title:"必须",width:"8%",render:()=>"必须"}]);return(async()=>{try{m(!0);const e=await se({types:r,domain:o,site_id:d}),{res:t}=e;if("证书申请并部署到网站成功"===t)ie(t),await(null==l?void 0:l()),await i(),n(),s.value="current",u();else{const e=t.split("\n");c.data=e.map((e=>{const[t,l]=e.split(/\s+/);return{key:t,value:l}})),p.value=c.data.length>0?c.data[0].key:""}}catch(e){e.res.includes("安装证书失败")&&(await(null==l?void 0:l()),await i(),n(),s.value="list",u())}finally{m(!1)}})(),(e,l)=>{const a=ct,s=f,i=t,n=wt;return Me(),Te("div",Oa,[Ue(i,null,{toolsLeft:$e((()=>[Xa])),content:$e((()=>[Ue(a,{loading:Ce(v),columns:Ce(h),data:Ce(c).data,"max-height":150},null,8,["loading","columns","data"])])),pageRight:$e((()=>[Ue(s,{type:"primary",onClick:_},{default:$e((()=>[Ae("验证")])),_:1})])),_:1}),Ue(n,{class:"mt-16px"},{default:$e((()=>[Ga,""!==Ce(p)?(Me(),Te("li",Qa,Le("可通过CMD命令来手动验证域名解析是否生效，例如: nslookup -q=txt "+Ce(p)),1)):Re("",!0)])),_:1})])}}}),Za=Pe("li",{class:"text-error"},"注意：请勿将SSL证书用于非法网站",-1),Ya=Pe("li",null,"申请之前，请确保域名已解析，如未解析会导致审核失败",-1),es=Pe("li",null,"Let's Encrypt免费证书，有效期3个月，支持多域名。",-1),ts=Pe("li",null,"若您的站点使用了CDN或301重定向会导致续签失败",-1),ls=Pe("li",null,"在未指定SSL默认站点时,未开启SSL的站点使用HTTPS会直接访问到已开启SSL的站点",-1),as=[Pe("li",null,"在DNS验证中，我们提供了多种自动化DNS-API，并提供了手动模式",-1),Pe("li",null,"使用DNS接口申请证书可自动续期，手动模式下证书到期后需重新申请",-1),Pe("li",null,"使用【DnsPod/阿里云DNS】等接口前您需要先在弹出的窗口中设置对应接口的API",-1)],ss=Pe("li",null,"如开启后无法使用HTTPS访问，请检查安全组是否正确放行443端口",-1),is=he({__name:"index",setup:e=>(e,t)=>{const l=S,a=wt;return Me(),Ee(a,{class:"mt-16px"},{default:$e((()=>[Za,Pe("div",null,[Pe("li",null,[Ae(" Let's Encrypt 证书申请和续签限制 "),Ue(l,{href:"https://letsencrypt.org/zh-cn/docs/rate-limits/",target:"_blank"},{default:$e((()=>[Ae("点击查看")])),_:1})]),Ya,es,ts,ls]),Ke(Pe("div",null,as,512),[[He,!1]]),ss])),_:1})}}),ns=e=>(je("data-v-5dae7309"),e=e(),ze(),e),os={class:"w-150px"},rs=ns((()=>Pe("p",{class:"text-desc mt-10px"}," * 如需申请通配符域名请勾选此项且不要在下方域名列表选中*.xxx.com ",-1))),ds={class:"domain"},us={class:"flex items-center mb-10px"},cs={class:"ml-10px text-desc"},ps=ns((()=>Pe("div",{class:"icon"},null,-1))),vs={class:"tip"},ms=_(he({__name:"index",setup(e){const{row:t}=we("component-data"),{getInfo:l}=we(Ql),a=k(),{menu:s}=be(a),{getList:i,setSsl:n}=a,o=ke({types:"http",domain:[]}),r=ke("手动解析"),d=ke([]),u=ke([{label:"手动解析",value:"手动解析"}]),{loading:c,setLoading:p}=R(),v=async()=>{try{p(!0);const{res:e}=await re({site_id:t.site_id,types:o.value.types}),{list:l}=e;B(l)&&(d.value=l.map((e=>"*"===e.domain_string?{domain_string:"通配所有域名"}:{domain_string:e.domain_string})))}finally{p(!1)}},m=Fe({show:!1,title:"设置【】接口",data:{key:""}}),_=Fe({show:!1,title:"手动解析TXT记录",data:{list:"",domain:[],types:"",siteId:t.site_id,cancelModal:()=>{_.show=!1}}}),h=Fe({show:!1,msg:""}),y=ke(!1),x=()=>{y.value?o.value.domain=[]:o.value.domain=d.value.map((e=>e.domain_string)),y.value=!y.value},S=e=>{const t=u.value.find((t=>t.value===e));"手动解析"!==e&&(m.show=!0,m.title="设置【".concat(null==t?void 0:t.label,"】接口"),m.data.key=(null==t?void 0:t.value)||"")},w=async()=>{if(0===o.value.domain.length)oe("至少需要有一个域名");else try{ne("正在申请证书...");const e=await de({...Qe(o.value),site_id:t.site_id});"http"===o.value.types?(ie(e.res),await(null==l?void 0:l()),await i(),n(),s.value="current"):(_.show=!0,_.data.list=e.res,_.data.domain=o.value.domain,_.data.types=o.value.types),ne("正在申请证书...").close()}catch(e){ne("正在申请证书...").close(),h.show=!0,h.msg=e.res}};return v(),(e,t)=>{const l=vt,a=pt,s=I,i=mt,n=et,p=f,b=bt,g=gt,k=tt,C=z,M=H,T=q,P=U,L=ue,$=ce;return Me(),Te("div",null,[Ue(T,{model:Ce(o),"label-placement":"left","label-width":"100"},{default:$e((()=>[Ue(s,{label:"验证方式"},{default:$e((()=>[Ue(a,{value:Ce(o).types,"onUpdate:value":[t[0]||(t[0]=e=>Ce(o).types=e),v]},{default:$e((()=>[Ue(l,{value:"http"},{default:$e((()=>[Ae("文件验证")])),_:1}),Ue(l,{class:"ml-15px",value:"dns"},{default:$e((()=>[Ae(" DNS验证（支持通配符） ")])),_:1})])),_:1},8,["value"])])),_:1}),"dns"===Ce(o).types?(Me(),Ee(s,{key:0,label:"选择DNS接口"},{default:$e((()=>[Pe("div",null,[Pe("div",os,[Ue(i,{value:Ce(r),"onUpdate:value":[t[1]||(t[1]=e=>Be(r)?r.value=e:null),S],options:Ce(u)},null,8,["value","options"])]),Ke(Pe("div",null,[Ue(n,{class:"mt-10px"},{default:$e((()=>[Ae(" 自动组合泛域名 ")])),_:1}),rs],512),[[He,!1]])])])),_:1})):Re("",!0),Ue(s,{label:"域名"},{default:$e((()=>[Pe("div",ds,[Pe("div",us,[Ue(p,{size:"tiny",secondary:"",strong:"",onClick:x},{default:$e((()=>[Ae(Le(Ce(y)?"取消全选":"全选"),1)])),_:1}),Pe("div",cs,"已选 "+Le(Ce(o).domain.length)+" 项",1)]),Ue(M,{style:{"max-height":"100px"}},{default:$e((()=>[Ue(C,{show:Ce(c)},{default:$e((()=>[Ue(k,{value:Ce(o).domain,"onUpdate:value":t[2]||(t[2]=e=>Ce(o).domain=e)},{default:$e((()=>[Ue(g,{"y-gap":8,cols:1},{default:$e((()=>[(Me(!0),Te(Ne,null,Xe(Ce(d),((e,t)=>(Me(),Ee(b,{key:t},{default:$e((()=>[Ue(n,{value:e.domain_string,label:e.domain_string},null,8,["value","label"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1},8,["show"])])),_:1})])])),_:1}),Ue(s,{label:" ","show-feedback":!1},{default:$e((()=>[Ue(p,{type:"primary",onClick:w},{default:$e((()=>[Ae("申请")])),_:1})])),_:1})])),_:1},8,["model"]),Ue(is,{value:Ce(o).types,"onUpdate:value":t[3]||(t[3]=e=>Ce(o).types=e)},null,8,["value"]),Ue(P,{show:Ce(_).show,"onUpdate:show":t[4]||(t[4]=e=>Ce(_).show=e),title:Ce(_).title,data:Ce(_).data,"is-footer":!1,component:Ja},null,8,["show","title","data"]),Ue(P,{show:Ce(m).show,"onUpdate:show":t[5]||(t[5]=e=>Ce(m).show=e),data:Ce(m).data,title:Ce(m).title,"is-footer":!0,component:Va},null,8,["show","data","title"]),Ue($,{show:Ce(h).show,"onUpdate:show":t[6]||(t[6]=e=>Ce(h).show=e)},{default:$e((()=>[Ue(L,{class:"main-box",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:$e((()=>[ps,Pe("div",vs,Le(Ce(h).msg),1)])),_:1})])),_:1},8,["show"])])}}}),[["__scopeId","data-v-5dae7309"]]),fs={class:"w-660px min-h-560px"},_s=he({__name:"index",setup(e){const{row:t}=we("component-data"),l=k(),{sslDetail:a,setSsl:s}=l,{menu:i}=be(l),n=ye((()=>a.ssl)),o=ye((()=>a.listen_ssl_port)),r=ye((()=>"default_wildcard_domain_server"===t.site_id));return Se(Ql,{info:n,listenPort:o}),s(),Je((()=>{1!==n.value.is_ssl&&"default_wildcard_domain_server"!==t.site_id?i.value="encrypt":i.value="current"})),(e,t)=>{const l=pe,a=St;return Me(),Te("div",fs,[Ue(a,{value:Ce(i),"onUpdate:value":t[0]||(t[0]=e=>Be(i)?i.value=e:null),class:"h-full"},{default:$e((()=>[Ue(l,{name:"current"},{tab:$e((()=>[Pe("div",null,[Pe("span",null,Le(e.$t("Site.SslModal.Menu1")),1),Pe("span",{class:Ze(1===Ce(n).is_ssl?"text-primary":"text-error")}," ["+Le(1===Ce(n).is_ssl?e.$t("Site.SslModal.Deployed"):e.$t("Site.SslModal.NonDeployed"))+"] ",3)])])),default:$e((()=>[Ue(Ma)])),_:1}),Ce(r)?Re("",!0):(Me(),Ee(l,{key:0,name:"encrypt",tab:"Let's Encrypt"},{default:$e((()=>[Ue(ms)])),_:1})),Ue(l,{name:"list",tab:e.$t("Site.SslModal.Menu2")},{default:$e((()=>[Ue(qa)])),_:1},8,["tab"])])),_:1},8,["value"])])}}}),hs=e=>(je("data-v-e0de327c"),e=e(),ze(),e),ys={class:"w-540px"},xs={class:"p-24px pb-8px"},Ss={class:"flex-1"},ws={class:"flex items-center h-32px"},bs={class:"mt-8px"},gs={class:"flex-1"},ks={class:"flex items-center h-32px"},Cs=hs((()=>Pe("li",{style:{color:"red"}},"爬虫防护 当前为测试功能",-1))),Ms=hs((()=>Pe("li",null,[Pe("strong",null,"效果："),Ae("该功能开启后、会将网页进行随机加密、每次访问的网页将不一样、有效防止爬虫 ")],-1))),Ts=hs((()=>Pe("li",null,[Pe("strong",null,"影响："),Ae("开启后会导致比之前流量增加1倍、在某些及特殊情况下会导致网页打不开 ")],-1))),Ps=hs((()=>Pe("li",null,[Pe("strong",null,"建议："),Ae("测试业务可以尝试开启，但线上业务建议不要开启。")],-1))),Ls={class:"footer-btn"},Us=_(he({__name:"index",emits:["close"],setup(e,{emit:t}){const{row:l}=we("component-data"),a=k(),{getList:s}=a,i=ke(),n=Fe({encryption:{open:!1,type:"default",text:""}}),o=()=>{t("close")},r=async()=>n.encryption.open&&"text"===n.encryption.type&&!n.encryption.text?G("请输入自定义网页跳转内容"):(await ve({watermark:{open:!1,type:"default",text:""},site_id:l.site_id,...n}),s(),o(),!0);return n.encryption.open=l.waf_info.crawler.encryption.open,n.encryption.type=l.waf_info.crawler.encryption.type,n.encryption.text=l.waf_info.crawler.encryption.text,(e,t)=>{const l=dt,a=vt,s=pt,d=K,u=I,c=ht,p=q,v=S,m=wt,_=f;return Me(),Te("div",ys,[Pe("div",xs,[Ue(p,{ref_key:"formRef",ref:i,model:Ce(n),"label-width":"102","label-placement":"left","require-mark-placement":"left"},{default:$e((()=>[Ue(u,{label:"动态加密",prop:"encryption.open"},{default:$e((()=>[Pe("div",Ss,[Pe("div",ws,[Ue(l,{value:Ce(n).encryption.open,"onUpdate:value":t[0]||(t[0]=e=>Ce(n).encryption.open=e)},null,8,["value"])]),Ke(Pe("div",bs,[Pe("div",gs,[Pe("div",ks,[Ue(s,{value:Ce(n).encryption.type,"onUpdate:value":t[1]||(t[1]=e=>Ce(n).encryption.type=e)},{default:$e((()=>[Ue(a,{value:"default"},{default:$e((()=>[Ae("默认(带有宝塔标识)")])),_:1}),Ue(a,{value:"text"},{default:$e((()=>[Ae("自定义网页跳转内容")])),_:1})])),_:1},8,["value"])])]),Ue(c,null,{default:$e((()=>[Ke(Pe("div",null,[Ue(u,{prop:"encryption.text"},{default:$e((()=>[Ue(d,{value:Ce(n).encryption.text,"onUpdate:value":t[2]||(t[2]=e=>Ce(n).encryption.text=e),placeholder:"例如:www.bt.cn网页正在解密中,请稍后"},null,8,["value"])])),_:1})],512),[[He,"text"===Ce(n).encryption.type]])])),_:1})],512),[[He,Ce(n).encryption.open]])])])),_:1})])),_:1},8,["model"]),Ue(m,{class:"mt-16px"},{default:$e((()=>[Cs,Ms,Ts,Ps,Pe("li",null,[Ue(v,{href:"https://www.bt.cn/bbs/thread-139641-1-1.html",target:"_blank"},{default:$e((()=>[Ae(" 教程 ")])),_:1})])])),_:1})]),Pe("div",Ls,[Ue(_,{size:"small",class:"cancel-btn",color:"#cbcbcb",onClick:o},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Cancel")),1)])),_:1}),Ue(_,{type:"primary",size:"small",onClick:r},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Confirm")),1)])),_:1})])])}}}),[["__scopeId","data-v-e0de327c"]]),$s=e=>(je("data-v-2682a8b6"),e=e(),ze(),e),As={class:"w-540px"},Rs={class:"p-24px pb-8px"},Ds={class:"flex justify-between items-center"},Bs={class:"flex-1"},js={class:"flex items-center h-32px"},zs=$s((()=>Pe("li",{style:{color:"red"}},"等候室/限流 当前为测试功能",-1))),Is=$s((()=>Pe("li",null,[Pe("strong",null,"效果："),Ae("等待室开启后可以解决部分消峰问题")],-1))),Ws=$s((()=>Pe("li",null,[Pe("strong",null,"影响："),Ae("低版本的浏览器会存在一直转圈的情况")],-1))),Ns=$s((()=>Pe("li",null,[Pe("strong",null,"建议："),Ae("测试业务可以尝试开启，但线上业务建议不要开启。")],-1))),Fs=$s((()=>Pe("li",null,"默认策略:网站实时流量超1次才会触发。最多50个用户同时访问、超时时间10分钟。",-1))),Es=$s((()=>Pe("li",null,"QPS为0的时候则就不会检测QPS的次数",-1))),Ks={class:"footer-btn"},qs=_(he({__name:"index",emits:["close"],setup(e,{emit:t}){const{row:l}=we("component-data"),a=k(),{getList:s}=a,i=ke(),n=Fe({wait:{open:!1,type:"default",text:"",time:10,user:50,qps:1},open:!1}),o=()=>{t("close")},r=async()=>n.wait.open&&"text"===n.wait.type&&!n.wait.text?G("请输入自定义网页标识"):(await me({site_id:l.site_id,...n}),s(),o(),!0);return n.wait.open=l.waf_info.wait.open,n.wait.type=l.waf_info.wait.type,n.wait.text=l.waf_info.wait.text,n.wait.time=l.waf_info.wait.time,n.wait.user=l.waf_info.wait.user,n.wait.qps=l.waf_info.wait.qps,n.open=l.waf_info.cc.open,(e,t)=>{const l=dt,a=I,s=yt,d=vt,u=pt,c=K,p=ht,v=q,m=S,_=wt,h=f;return Me(),Te("div",As,[Pe("div",Rs,[Ue(v,{ref_key:"formRef",ref:i,model:Ce(n),"label-width":"102","label-placement":"left","require-mark-placement":"left"},{default:$e((()=>[Ue(a,{label:"CC拦截",prop:"open"},{default:$e((()=>[Ue(l,{value:Ce(n).open,"onUpdate:value":t[0]||(t[0]=e=>Ce(n).open=e)},null,8,["value"])])),_:1}),Ue(a,{label:"等候室开关",prop:"wait.open"},{default:$e((()=>[Ue(l,{value:Ce(n).wait.open,"onUpdate:value":t[1]||(t[1]=e=>Ce(n).wait.open=e)},null,8,["value"])])),_:1}),Ke(Ue(a,{label:"最大用户数"},{default:$e((()=>[Pe("div",Ds,[Ue(s,{value:Ce(n).wait.user,"onUpdate:value":t[2]||(t[2]=e=>Ce(n).wait.user=e),"show-button":!1,class:"w-12 mr-1"},null,8,["value"]),Ae(" 活跃超时时间 "),Ue(s,{value:Ce(n).wait.time,"onUpdate:value":t[3]||(t[3]=e=>Ce(n).wait.time=e),"show-button":!1,class:"w-10 mx-1"},null,8,["value"]),Ae(" 分钟, QPS超过 "),Ue(s,{value:Ce(n).wait.qps,"onUpdate:value":t[4]||(t[4]=e=>Ce(n).wait.qps=e),"show-button":!1,class:"w-12 mx-1"},null,8,["value"]),Ae(" 次 才会触发 ")])])),_:1},512),[[He,Ce(n).wait.open]]),Ke(Ue(a,{label:"标识页面"},{default:$e((()=>[Pe("div",null,[Pe("div",Bs,[Pe("div",js,[Ue(u,{value:Ce(n).wait.type,"onUpdate:value":t[5]||(t[5]=e=>Ce(n).wait.type=e)},{default:$e((()=>[Ue(d,{value:"default"},{default:$e((()=>[Ae("默认(带有宝塔标识6KB)")])),_:1}),Ue(d,{value:"text"},{default:$e((()=>[Ae("自定义网页内容(3KB)")])),_:1})])),_:1},8,["value"])])]),Ue(p,null,{default:$e((()=>[Ke(Pe("div",null,[Ue(a,{prop:"encryption.text"},{default:$e((()=>[Ue(c,{value:Ce(n).wait.text,"onUpdate:value":t[6]||(t[6]=e=>Ce(n).wait.text=e),placeholder:"例如:网站在线人数过多，需排队"},null,8,["value"])])),_:1})],512),[[He,"text"===Ce(n).wait.type]])])),_:1})])])),_:1},512),[[He,Ce(n).wait.open]])])),_:1},8,["model"]),Ue(_,{class:"mt-16px"},{default:$e((()=>[zs,Is,Ws,Ns,Fs,Es,Pe("li",null,[Ue(m,{href:"https://www.bt.cn/bbs/thread-141331-1-1.html",target:"_blank"},{default:$e((()=>[Ae(" 教程 ")])),_:1})])])),_:1})]),Pe("div",Ks,[Ue(h,{size:"small",class:"cancel-btn",color:"#cbcbcb",onClick:o},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Cancel")),1)])),_:1}),Ue(h,{type:"primary",size:"small",onClick:r},{default:$e((()=>[Ae(Le(e.$t("Public.Btn.Confirm")),1)])),_:1})])])}}}),[["__scopeId","data-v-2682a8b6"]]),Hs=he({__name:"index",setup(l){const a=k(),{table:s,search:i,getList:n,setSite:o}=a,{add:r}=be(a),{t:d}=ge(),u=Fe({show:!1,title:"",data:{row:ke()}}),c=Fe({show:!1,title:d("Site.AddModal.Title")}),p=()=>{c.show=!0},v=Fe({show:!1,title:"",data:{row:ke()}}),m=Fe({show:!1,title:"",data:{row:ke()}});return Se(Pt,{onAddSite:p,showSslModal:e=>{u.title=d("Site.SslModal.Title",{name:e.site_name}),u.data.row=e,u.show=!0,o(e)},showCrawlerModal:e=>{v.title="[".concat(e.site_name,"]爬虫防护"),v.data.row=e,v.show=!0},showWaitModal:e=>{m.title="[".concat(e.site_name,"]CC拦截"),m.data.row=e,m.show=!0}}),We((()=>{n(),r.value&&(r.value=!1,setTimeout((()=>{p()}),400))})),(l,a)=>{const o=_e,r=fe,d=U,p=t,f=e,_=Ye("en");return Me(),Ee(f,null,{default:$e((()=>[Ke(Ue(At,null,null,512),[[_]]),Ue(p,null,{toolsLeft:$e((()=>[Ue(It)])),toolsRight:$e((()=>[Ue(o,{value:Ce(i).site_name,"onUpdate:value":a[0]||(a[0]=e=>Ce(i).site_name=e),width:"300",placeholder:l.$t("Site.List.Search"),onSearch:a[1]||(a[1]=e=>Ce(n)())},null,8,["value","placeholder"])])),content:$e((()=>[Ue(Gt)])),pageRight:$e((()=>[Ue(r,{page:Ce(i).p,"onUpdate:page":a[2]||(a[2]=e=>Ce(i).p=e),"page-size":Ce(i).p_size,"onUpdate:pageSize":a[3]||(a[3]=e=>Ce(i).p_size=e),"store-key":"site","item-count":Ce(s).total,onRefresh:a[4]||(a[4]=e=>Ce(n)())},null,8,["page","page-size","item-count"])])),modal:$e((()=>[Ue(d,{show:Ce(c).show,"onUpdate:show":a[5]||(a[5]=e=>Ce(c).show=e),title:Ce(c).title,padding:"0",component:Gl},null,8,["show","title"]),Ue(d,{show:Ce(u).show,"onUpdate:show":a[6]||(a[6]=e=>Ce(u).show=e),title:Ce(u).title,data:Ce(u).data,component:_s},null,8,["show","title","data"]),Ue(d,{show:Ce(v).show,"onUpdate:show":a[7]||(a[7]=e=>Ce(v).show=e),title:Ce(v).title,padding:"0",data:Ce(v).data,component:Us},null,8,["show","title","data"]),Ue(d,{show:Ce(m).show,"onUpdate:show":a[8]||(a[8]=e=>Ce(m).show=e),title:Ce(m).title,padding:"0",data:Ce(m).data,component:qs},null,8,["show","title","data"])])),_:1})])),_:1})}}});export{Hs as default};
