import{bg as e,B as n,ca as t,dn as o,cc as l,bj as a,e4 as r,dq as i,bm as d,e5 as c,e6 as s,dp as u,e7 as f,cq as h,e8 as v,dl as p,D as g,K as y,L as b,dk as k,E as m,M as x,e9 as w,F as C,H as R,G as S,dt as N,ci as K,ea as D,eb as A,bs as F,I as L,ec as P,ed as T,bl as E,dg as O,_ as B,aG as I}from"./index.fc641b56.1742181728921.js";import{d as z,h as U,m as _,r as j,c as q,s as M,G as H,z as V,w as G,A as $,x as Y,o as W,b as X,e as J,B as Q,J as Z}from"./vue.314199b7.1742181728921.js";import{c as ee,_ as ne}from"./Checkbox.64335fca.1742181728921.js";import{V as te}from"./utils.d31cac41.1742181728921.js";function oe(e){return"string"==typeof e?"s-".concat(e):"n-".concat(e)}const le=z({name:"Switcher",render:()=>U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},U("path",{d:"M12 8l10 8l-10 8z"}))}),ae=e({name:"Tree",common:n,peers:{Checkbox:ee,Scrollbar:t,Empty:o},self:e=>{const{borderRadiusSmall:n,hoverColor:t,pressedColor:o,primaryColor:a,textColor3:r,textColor2:i,textColorDisabled:d,fontSize:c}=e;return{fontSize:c,nodeBorderRadius:n,nodeColorHover:t,nodeColorPressed:o,nodeColorActive:l(a,{alpha:.1}),arrowColor:r,nodeTextColor:i,nodeTextColorDisabled:d,loadingColor:a,dropMarkColor:a}}}),re=a("n-tree-select"),ie=a("n-tree"),de=z({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function},setup(e){const{renderSwitcherIconRef:n}=_(ie,null);return()=>{const{clsPrefix:t}=e;return U("span",{"data-switcher":!0,class:["".concat(t,"-tree-node-switcher"),e.expanded&&"".concat(t,"-tree-node-switcher--expanded"),e.hide&&"".concat(t,"-tree-node-switcher--hide")],onClick:e.onClick},U("div",{class:"".concat(t,"-tree-node-switcher__icon")},U(r,null,{default:()=>{if(e.loading)return U(i,{clsPrefix:t,key:"loading",radius:85,strokeWidth:20});const{value:o}=n;return o?o({expanded:e.expanded,selected:e.selected}):U(d,{clsPrefix:t,key:"switcher"},{default:()=>U(le,null)})}})))}}}),ce=z({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){function n(n){const{onCheck:t}=e;t&&t(n)}return{handleUpdateValue:function(t){e.indeterminate?n(!1):n(t)},mergedTheme:_(ie).mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:n,checked:t,indeterminate:o,disabled:l,focusable:a,handleUpdateValue:r}=this;return U("span",{class:["".concat(e,"-tree-node-checkbox"),this.right&&"".concat(e,"-tree-node-checkbox--right")],"data-checkbox":!0},U(ne,{focusable:a,disabled:l,theme:n.peers.Checkbox,themeOverrides:n.peerOverrides.Checkbox,checked:t,indeterminate:o,onUpdateChecked:r}))}}),se=z({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:n,renderPrefixRef:t,renderSuffixRef:o,labelFieldRef:l}=_(ie);return{selfRef:j(null),renderLabel:n,renderPrefix:t,renderSuffix:o,labelField:l,handleClick:function(n){!function(n){const{onClick:t}=e;t&&t(n)}(n)}}},render(){const{clsPrefix:e,labelField:n,nodeProps:t,checked:o=!1,selected:l=!1,renderLabel:a,renderPrefix:r,renderSuffix:i,handleClick:d,onDragstart:s,tmNode:{rawNode:u,rawNode:{prefix:f,suffix:h,[n]:v}}}=this;return U("span",Object.assign({},t,{ref:"selfRef",class:["".concat(e,"-tree-node-content"),null==t?void 0:t.class],onClick:d,draggable:void 0!==s||void 0,onDragstart:s}),r||f?U("div",{class:"".concat(e,"-tree-node-content__prefix")},r?r({option:u,selected:l,checked:o}):c(f)):null,U("div",{class:"".concat(e,"-tree-node-content__text")},a?a({option:u,selected:l,checked:o}):c(v)),i||h?U("div",{class:"".concat(e,"-tree-node-content__suffix")},i?i({option:u,selected:l,checked:o}):c(h)):null)}});function ue({position:e,offsetLevel:n,indent:t,el:o}){const l={position:"absolute",boxSizing:"border-box",right:0};if("inside"===e)l.left=0,l.top=0,l.bottom=0,l.borderRadius="inherit",l.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const a="before"===e?"top":"bottom";l[a]=0,l.left="".concat(o.offsetLeft+6-n*t,"px"),l.height="2px",l.backgroundColor="var(--n-drop-mark-color)",l.transformOrigin=a,l.borderRadius="1px",l.transform="before"===e?"translateY(-4px)":"translateY(4px)"}return U("div",{style:l})}function fe(e,n){return!!e.rawNode[n]}function he(e,n,t,o){null==e||e.forEach((e=>{t(e),he(e[n],n,t,o),o(e)}))}function ve(e,n,t,o,l){const a=new Set,r=new Set,i=[];return he(e,o,(e=>{if(i.push(e),l(n,e)){r.add(e[t]);for(let e=i.length-2;e>=0;--e){if(a.has(i[e][t]))return;a.add(i[e][t])}}}),(()=>{i.pop()})),{expandedKeys:Array.from(a),highlightKeySet:r}}if(s&&Image){(new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}const pe=z({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const n=_(ie),{droppingNodeParentRef:t,droppingMouseNodeRef:o,draggingNodeRef:l,droppingPositionRef:a,droppingOffsetLevelRef:r,nodePropsRef:i,indentRef:d,blockLineRef:c,checkboxPlacementRef:s,checkOnClickRef:f,disabledFieldRef:v}=n,p=u((()=>!!e.tmNode.rawNode.checkboxDisabled)),g=u((()=>fe(e.tmNode,v.value))),y=u((()=>n.disabledRef.value||g.value)),b=q((()=>{const{value:n}=i;if(n)return n({option:e.tmNode.rawNode})})),k=j(null),m={value:null};function x(){const{tmNode:t}=e;if(t.isLeaf||t.shallowLoaded)n.handleSwitcherClick(t);else{if(n.loadingKeysRef.value.has(t.key))return;n.loadingKeysRef.value.add(t.key);const{onLoadRef:{value:e}}=n;e&&e(t.rawNode).then((e=>{!1!==e&&n.handleSwitcherClick(t)})).finally((()=>{n.loadingKeysRef.value.delete(t.key)}))}}M((()=>{m.value=k.value.$el}));const w=u((()=>!g.value&&n.selectableRef.value&&(!n.internalTreeSelect||("child"!==n.mergedCheckStrategyRef.value||n.multipleRef.value&&n.cascadeRef.value||e.tmNode.isLeaf)))),C=u((()=>n.checkableRef.value&&(n.cascadeRef.value||"child"!==n.mergedCheckStrategyRef.value||e.tmNode.isLeaf))),R=u((()=>n.displayedCheckedKeysRef.value.includes(e.tmNode.key))),S=u((()=>{const{value:n}=C;if(!n)return!1;const{value:t}=f;return"boolean"==typeof t?t:t(e.tmNode.rawNode)}));function N(t){const{value:o}=n.expandOnClickRef,{value:l}=w,{value:a}=S;if(!l&&!o&&!a)return;if(h(t,"checkbox")||h(t,"switcher"))return;const{tmNode:r}=e;l&&n.handleSelect(r),o&&!r.isLeaf&&x(),a&&K(!R.value)}function K(t){n.handleCheck(e.tmNode,t)}return{showDropMark:u((()=>{const{value:n}=l;if(!n)return;const{value:t}=a;if(!t)return;const{value:r}=o;if(!r)return;const{tmNode:i}=e;return i.key===r.key})),showDropMarkAsParent:u((()=>{const{value:n}=t;if(!n)return!1;const{tmNode:o}=e,{value:l}=a;return("before"===l||"after"===l)&&n.key===o.key})),pending:u((()=>n.pendingNodeKeyRef.value===e.tmNode.key)),loading:u((()=>n.loadingKeysRef.value.has(e.tmNode.key))),highlight:u((()=>{var t;return null===(t=n.highlightKeySetRef.value)||void 0===t?void 0:t.has(e.tmNode.key)})),checked:R,indeterminate:u((()=>n.displayedIndeterminateKeysRef.value.includes(e.tmNode.key))),selected:u((()=>n.mergedSelectedKeysRef.value.includes(e.tmNode.key))),expanded:u((()=>n.mergedExpandedKeysRef.value.includes(e.tmNode.key))),disabled:y,checkable:C,mergedCheckOnClick:S,checkboxDisabled:p,selectable:w,expandOnClick:n.expandOnClickRef,internalScrollable:n.internalScrollableRef,draggable:n.draggableRef,blockLine:c,nodeProps:b,checkboxFocusable:n.internalCheckboxFocusableRef,droppingPosition:a,droppingOffsetLevel:r,indent:d,checkboxPlacement:s,contentInstRef:k,contentElRef:m,handleCheck:K,handleDrop:function(t){t.preventDefault(),null!==a.value&&n.handleDrop({event:t,node:e.tmNode,dropPosition:a.value})},handleDragStart:function(t){n.handleDragStart({event:t,node:e.tmNode})},handleDragEnter:function(t){t.currentTarget===t.target&&n.handleDragEnter({event:t,node:e.tmNode})},handleDragOver:function(t){t.preventDefault(),n.handleDragOver({event:t,node:e.tmNode})},handleDragEnd:function(t){n.handleDragEnd({event:t,node:e.tmNode})},handleDragLeave:function(t){t.currentTarget===t.target&&n.handleDragLeave({event:t,node:e.tmNode})},handleLineClick:function(e){var n,t;c.value&&(y.value||N(e),null===(t=null===(n=b.value)||void 0===n?void 0:n.onClick)||void 0===t||t.call(n,e))},handleContentClick:function(e){var n,t;c.value||(y.value||N(e),null===(t=null===(n=b.value)||void 0===n?void 0:n.onClick)||void 0===t||t.call(n,e))},handleSwitcherClick:x}},render(){const{tmNode:e,clsPrefix:n,checkable:t,expandOnClick:o,selectable:l,selected:a,checked:r,highlight:i,draggable:d,blockLine:c,indent:s,disabled:u,pending:h,internalScrollable:v,nodeProps:p,checkboxPlacement:g}=this,y=d&&!u?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,b=v?oe(e.key):void 0,k="right"===g,m=t?U(ce,{right:k,focusable:this.checkboxFocusable,disabled:u||this.checkboxDisabled,clsPrefix:n,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return U("div",Object.assign({class:"".concat(n,"-tree-node-wrapper")},y),U("div",Object.assign({},c?p:void 0,{class:["".concat(n,"-tree-node"),{["".concat(n,"-tree-node--selected")]:a,["".concat(n,"-tree-node--checkable")]:t,["".concat(n,"-tree-node--highlight")]:i,["".concat(n,"-tree-node--pending")]:h,["".concat(n,"-tree-node--disabled")]:u,["".concat(n,"-tree-node--selectable")]:l,["".concat(n,"-tree-node--clickable")]:l||o||this.mergedCheckOnClick},null==p?void 0:p.class],"data-key":b,draggable:d&&c,onClick:this.handleLineClick,onDragstart:d&&c&&!u?this.handleDragStart:void 0}),f(e.level,U("div",{class:"".concat(n,"-tree-node-indent")},U("div",{style:{width:"".concat(s,"px")}}))),U(de,{clsPrefix:n,expanded:this.expanded,selected:a,loading:this.loading,hide:e.isLeaf,onClick:this.handleSwitcherClick}),k?null:m,U(se,{ref:"contentInstRef",clsPrefix:n,checked:r,selected:a,onClick:this.handleContentClick,nodeProps:c?void 0:p,onDragstart:!d||c||u?void 0:this.handleDragStart,tmNode:e}),d?this.showDropMark?ue({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:s}):this.showDropMarkAsParent?ue({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:s}):null:null,k?m:null))}});const ge=z({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return U(p,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:"collapse"===this.mode},{default:()=>U("div",{class:["".concat(e,"-tree-motion-wrapper"),"".concat(e,"-tree-motion-wrapper--").concat(this.mode)],style:{height:v(this.height)}},this.nodes.map((n=>U(pe,{clsPrefix:e,tmNode:n}))))})}}),ye=g("tree","\n font-size: var(--n-font-size);\n outline: none;\n",[y("ul, li","\n margin: 0;\n padding: 0;\n list-style: none;\n "),y(">",[g("tree-node",[y("&:first-child",{marginTop:0})])]),g("tree-node-indent","\n flex-grow: 0;\n flex-shrink: 0;\n height: 0;\n "),g("tree-motion-wrapper",[b("expand",[k({duration:"0.2s"})]),b("collapse",[k({duration:"0.2s",reverse:!0})])]),g("tree-node-wrapper","\n box-sizing: border-box;\n padding: 3px 0;\n "),g("tree-node","\n transform: translate3d(0,0,0);\n position: relative;\n display: flex;\n border-radius: var(--n-node-border-radius);\n transition: background-color .3s var(--n-bezier);\n ",[b("highlight",[g("tree-node-content",[m("text",{borderBottomColor:"var(--n-node-text-color-disabled)"})])]),b("disabled",[g("tree-node-content","\n color: var(--n-node-text-color-disabled);\n cursor: not-allowed;\n ")]),x("disabled",[b("clickable",[g("tree-node-content","\n cursor: pointer;\n ")])])]),b("block-node",[g("tree-node-content","\n flex: 1;\n min-width: 0;\n ")]),x("block-line",[g("tree-node",[x("disabled",[g("tree-node-content",[y("&:hover",{backgroundColor:"var(--n-node-color-hover)"})]),b("selectable",[g("tree-node-content",[y("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),b("pending",[g("tree-node-content","\n background-color: var(--n-node-color-hover);\n ")]),b("selected",[g("tree-node-content",{backgroundColor:"var(--n-node-color-active)"})])])])]),b("block-line",[g("tree-node",[x("disabled",[y("&:hover",{backgroundColor:"var(--n-node-color-hover)"}),b("pending","\n background-color: var(--n-node-color-hover);\n "),b("selectable",[x("selected",[y("&:active",{backgroundColor:"var(--n-node-color-pressed)"})])]),b("selected",{backgroundColor:"var(--n-node-color-active)"})]),b("disabled","\n cursor: not-allowed;\n ")])]),g("tree-node-switcher","\n cursor: pointer;\n display: inline-flex;\n flex-shrink: 0;\n height: 24px;\n width: 24px;\n align-items: center;\n justify-content: center;\n transition: transform .15s var(--n-bezier);\n vertical-align: bottom;\n ",[m("icon","\n position: relative;\n height: 14px;\n width: 14px;\n display: flex;\n color: var(--n-arrow-color);\n transition: color .3s var(--n-bezier);\n font-size: 14px;\n ",[g("icon",[w()]),g("base-loading","\n color: var(--n-loading-color);\n position: absolute;\n left: 0;\n top: 0;\n right: 0;\n bottom: 0;\n ",[w()]),g("base-icon",[w()])]),b("hide",{visibility:"hidden"}),b("expanded",{transform:"rotate(90deg)"})]),g("tree-node-checkbox","\n display: inline-flex;\n height: 24px;\n width: 16px;\n vertical-align: bottom;\n align-items: center;\n justify-content: center;\n margin-right: 4px;\n ",[b("right","margin-left: 4px;")]),b("checkable",[g("tree-node-content","\n padding: 0 6px;\n ")]),g("tree-node-content","\n position: relative;\n display: inline-flex;\n align-items: center;\n min-height: 24px;\n box-sizing: border-box;\n line-height: 1.5;\n vertical-align: bottom;\n padding: 0 6px 0 4px;\n cursor: default;\n border-radius: var(--n-node-border-radius);\n text-decoration-color: #0000;\n text-decoration-line: underline;\n color: var(--n-node-text-color);\n transition:\n color .3s var(--n-bezier),\n text-decoration-color .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n ",[y("&:last-child",{marginBottom:0}),m("prefix","\n display: inline-flex;\n margin-right: 8px;\n "),m("text","\n border-bottom: 1px solid #0000;\n transition: border-color .3s var(--n-bezier);\n flex-grow: 1;\n max-width: 100%;\n "),m("suffix","\n display: inline-flex;\n ")]),m("empty","margin: auto;")]);var be=globalThis&&globalThis.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(l,a){function r(e){try{d(o.next(e))}catch(n){a(n)}}function i(e){try{d(o.throw(e))}catch(n){a(n)}}function d(e){var n;e.done?l(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,i)}d((o=o.apply(e,n||[])).next())}))};const ke={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array]},me=z({name:"Tree",props:Object.assign(Object.assign(Object.assign(Object.assign({},S.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},indent:{type:Number,default:16},allowDrop:{type:Function,default:function({dropPosition:e,node:n}){return!1===n.isLeaf||(!!n.children||"inside"!==e)}},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),ke),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),setup(e){const{mergedClsPrefixRef:n,inlineThemeDisabled:t,mergedRtlRef:o}=C(e),l=R("Tree",o,n),a=S("Tree","-tree",ye,ae,e,n),r=j(null),i=j(null),d=j(null);const c=q((()=>{const{filter:n}=e;if(n)return n;const{labelField:t}=e;return(e,n)=>{if(!e.length)return!0;const o=n[t];return"string"==typeof o&&o.toLowerCase().includes(e.toLowerCase())}})),s=q((()=>{const{pattern:n}=e;return n&&n.length&&c.value?function(e,n,t,o,l){const a=new Set,r=new Set,i=new Set,d=[],c=[],s=[];return function e(d){d.forEach((d=>{if(s.push(d),n(t,d)){a.add(d[o]),i.add(d[o]);for(let e=s.length-2;e>=0;--e){const n=s[e][o];if(r.has(n))break;r.add(n),a.has(n)&&a.delete(n)}}const c=d[l];c&&e(c),s.pop()}))}(e),function e(n,t){n.forEach((n=>{const i=n[o],c=a.has(i),s=r.has(i);if(!c&&!s)return;const u=n[l];if(u)if(c)t.push(n);else{d.push(i);const o=Object.assign(Object.assign({},n),{[l]:[]});t.push(o),e(u,o[l])}else t.push(n)}))}(e,c),{filteredTree:c,highlightKeySet:i,expandedKeys:d}}(e.data,c.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}})),u=q((()=>{return N(e.showIrrelevantNodes?e.data:s.value.filteredTree,(n=e.keyField,t=e.childrenField,o=e.disabledField,{getIsGroup:()=>!1,getKey:e=>e[n],getChildren:e.getChildren||(e=>e[t]),getDisabled:e=>!(!e[o]&&!e.checkboxDisabled)}));var n,t,o})),f=_(re,null),h=e.internalTreeSelect?f.dataTreeMate:u,{watchProps:v}=e,p=j([]);(null==v?void 0:v.includes("defaultCheckedKeys"))?H((()=>{p.value=e.defaultCheckedKeys})):p.value=e.defaultCheckedKeys;const g=V(e,"checkedKeys"),y=K(g,p),b=q((()=>h.value.getCheckedKeys(y.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded}))),k=function(e){return q((()=>e.leafOnly?"child":e.checkStrategy))}(e),m=q((()=>b.value.checkedKeys)),x=q((()=>{const{indeterminateKeys:n}=e;return void 0!==n?n:b.value.indeterminateKeys})),w=j([]);(null==v?void 0:v.includes("defaultSelectedKeys"))?H((()=>{w.value=e.defaultSelectedKeys})):w.value=e.defaultSelectedKeys;const P=V(e,"selectedKeys"),T=K(P,w),E=j([]),O=n=>{E.value=e.defaultExpandAll?h.value.getNonLeafKeys():void 0===n?e.defaultExpandedKeys:n};(null==v?void 0:v.includes("defaultExpandedKeys"))?H((()=>{O(void 0)})):H((()=>{O(e.defaultExpandedKeys)}));const B=V(e,"expandedKeys"),I=K(B,E),z=q((()=>u.value.getFlattenedNodes(I.value))),{pendingNodeKeyRef:U,handleKeydown:M}=function({props:e,fNodesRef:n,mergedExpandedKeysRef:t,mergedSelectedKeysRef:o,handleSelect:l,handleSwitcherClick:a}){const{value:r}=o,i=_(re,null),d=i?i.pendingNodeKeyRef:j(r.length?r[r.length-1]:null);return{pendingNodeKeyRef:d,handleKeydown:function(o){if(!e.keyboard)return;const{value:r}=d;if(null===r){if("ArrowDown"!==o.key&&"ArrowUp"!==o.key||o.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(o.key)&&null===r){const{value:e}=n;let t=0;for(;t<e.length;){if(!e[t].disabled){d.value=e[t].key;break}t+=1}}}else{const{value:e}=n;let i=e.findIndex((e=>e.key===r));if(!~i)return;if("Enter"===o.key)l(e[i]);else if("ArrowDown"===o.key)for(o.preventDefault(),i+=1;i<e.length;){if(!e[i].disabled){d.value=e[i].key;break}i+=1}else if("ArrowUp"===o.key)for(o.preventDefault(),i-=1;i>=0;){if(!e[i].disabled){d.value=e[i].key;break}i-=1}else if("ArrowLeft"===o.key){const n=e[i];if(n.isLeaf||!t.value.includes(r)){const e=n.getParent();e&&(d.value=e.key)}else a(n)}else if("ArrowRight"===o.key){const n=e[i];if(n.isLeaf)return;if(t.value.includes(r))for(i+=1;i<e.length;){if(!e[i].disabled){d.value=e[i].key;break}i+=1}else a(n)}}}}}({props:e,mergedSelectedKeysRef:T,fNodesRef:z,mergedExpandedKeysRef:I,handleSelect:Oe,handleSwitcherClick:Ee});let W=null,X=null;const J=j(new Set),Q=q((()=>e.internalHighlightKeySet||s.value.highlightKeySet)),Z=K(Q,J),ee=j(new Set),ne=q((()=>I.value.filter((e=>!ee.value.has(e)))));let te=0;const le=j(null),de=j(null),ce=j(null),se=j(null),ue=j(0),he=q((()=>{const{value:e}=de;return e?e.parent:null}));G(V(e,"data"),(()=>{ee.value.clear(),U.value=null,Fe()}),{deep:!1});let pe=!1;const ge=()=>{pe=!0,$((()=>{pe=!1}))};let ke;function me(n){return be(this,void 0,void 0,(function*(){const{onLoad:t}=e;if(!t)return void(yield Promise.resolve());const{value:o}=ee;if(!o.has(n.key)){o.add(n.key);try{!1===(yield t(n.rawNode))&&Pe()}catch(l){Pe()}o.delete(n.key)}}))}G(V(e,"pattern"),((n,t)=>{if(e.showIrrelevantNodes)if(ke=void 0,n){const{expandedKeys:n,highlightKeySet:t}=ve(e.data,e.pattern,e.keyField,e.childrenField,c.value);J.value=t,ge(),Ke(n,Ne(n),{node:null,action:"filter"})}else J.value=new Set;else if(n.length){t.length||(ke=I.value);const{expandedKeys:e}=s.value;void 0!==e&&(ge(),Ke(e,Ne(e),{node:null,action:"filter"}))}else void 0!==ke&&(ge(),Ke(ke,Ne(ke),{node:null,action:"filter"}))})),H((()=>{var e;const{value:n}=u;if(!n)return;const{getNode:t}=n;null===(e=I.value)||void 0===e||e.forEach((e=>{const n=t(e);n&&!n.shallowLoaded&&me(n)}))}));const xe=j(!1),we=j([]);G(ne,((n,t)=>{if(!e.animated||pe)return void $(Se);const o=new Set(t);let l=null,a=null;for(const e of n)if(!o.has(e)){if(null!==l)return;l=e}const i=new Set(n);for(const e of t)if(!i.has(e)){if(null!==a)return;a=e}if(null===l&&null===a)return;const{virtualScroll:c}=e,s=(c?d.value.listElRef:r.value).offsetHeight,f=Math.ceil(s/30)+1;let h;if(null!==l&&(h=t),null!==a&&(h=void 0===h?n:h.filter((e=>e!==a))),xe.value=!0,we.value=u.value.getFlattenedNodes(h),null!==l){const e=we.value.findIndex((e=>e.key===l));if(~e){const t=we.value[e].children;if(t){const o=D(t,n);we.value.splice(e+1,0,{__motion:!0,mode:"expand",height:c?30*o.length:void 0,nodes:c?o.slice(0,f):o})}}}if(null!==a){const e=we.value.findIndex((e=>e.key===a));if(~e){const t=we.value[e].children;if(!t)return;xe.value=!0;const o=D(t,n);we.value.splice(e+1,0,{__motion:!0,mode:"collapse",height:c?30*o.length:void 0,nodes:c?o.slice(0,f):o})}}}));const Ce=q((()=>A(z.value))),Re=q((()=>xe.value?we.value:z.value));function Se(){const{value:e}=i;e&&e.sync()}function Ne(e){const{getNode:n}=h.value;return e.map((e=>{var t;return(null===(t=n(e))||void 0===t?void 0:t.rawNode)||null}))}function Ke(n,t,o){const{"onUpdate:expandedKeys":l,onUpdateExpandedKeys:a}=e;E.value=n,l&&F(l,n,t,o),a&&F(a,n,t,o)}function De(n,t,o){const{"onUpdate:checkedKeys":l,onUpdateCheckedKeys:a}=e;p.value=n,a&&F(a,n,t,o),l&&F(l,n,t,o)}function Ae(n,t,o){const{"onUpdate:selectedKeys":l,onUpdateSelectedKeys:a}=e;w.value=n,a&&F(a,n,t,o),l&&F(l,n,t,o)}function Fe(){le.value=null,Le()}function Le(){ue.value=0,de.value=null,ce.value=null,se.value=null,Pe()}function Pe(){W&&(window.clearTimeout(W),W=null),X=null}function Te(n,t){if(e.disabled||fe(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple)return void Oe(n);const o=t?"check":"uncheck",{checkedKeys:l,indeterminateKeys:a}=h.value[o](n.key,m.value,{cascade:e.cascade,checkStrategy:k.value,allowNotLoaded:e.allowCheckingNotLoaded});De(l,Ne(l),{node:n.rawNode,action:o}),function(n,t){const{"onUpdate:indeterminateKeys":o,onUpdateIndeterminateKeys:l}=e;o&&F(o,n,t),l&&F(l,n,t)}(a,Ne(a))}function Ee(n){e.disabled||xe.value||function(n){if(e.disabled)return;const{key:t}=n,{value:o}=I,l=o.findIndex((e=>e===t));if(~l){const e=Array.from(o);e.splice(l,1),Ke(e,Ne(e),{node:n.rawNode,action:"collapse"})}else{const l=u.value.getNode(t);if(!l||l.isLeaf)return;let a;if(e.accordion){const e=new Set(n.siblings.map((({key:e})=>e)));a=o.filter((n=>!e.has(n))),a.push(t)}else a=o.concat(t);Ke(a,Ne(a),{node:n.rawNode,action:"expand"})}}(n)}function Oe(n){if(!e.disabled&&e.selectable){if(U.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:t,indeterminateKeys:o}}=b;e.multiple?Te(n,!(t.includes(n.key)||o.includes(n.key))):De([n.key],Ne([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const t=Array.from(T.value),o=t.findIndex((e=>e===n.key));~o?e.cancelable&&t.splice(o,1):~o||t.push(n.key),Ae(t,Ne(t),{node:n.rawNode,action:~o?"unselect":"select"})}else{T.value.includes(n.key)?e.cancelable&&Ae([],[],{node:n.rawNode,action:"unselect"}):Ae([n.key],Ne([n.key]),{node:n.rawNode,action:"select"})}}}function Be({event:n,node:t},o=!0){var l;if(!e.draggable||e.disabled||fe(t,e.disabledField))return;const{value:a}=le;if(!a)return;const{allowDrop:r,indent:i}=e;o&&function(n){const{onDragover:t}=e;t&&F(t,n)}({event:n,node:t.rawNode});const d=n.currentTarget,{height:c,top:s}=d.getBoundingClientRect(),u=n.clientY-s;let f;f=r({node:t.rawNode,dropPosition:"inside",phase:"drag"})?u<=8?"before":u>=c-8?"after":"inside":u<=c/2?"before":"after";const{value:h}=Ce;let v,p;const g=h(t.key);if(null===g)return void Le();let y=!1;"inside"===f?(v=t,p="inside"):"before"===f?t.isFirstChild?(v=t,p="before"):(v=z.value[g-1],p="after"):(v=t,p="after"),!v.isLeaf&&I.value.includes(v.key)&&(y=!0,"after"===p&&(v=z.value[g+1],v?p="before":(v=t,p="inside")));const b=v;if(ce.value=b,!y&&a.isLastChild&&a.key===v.key&&(p="after"),"after"===p){let e=te-n.clientX,t=0;for(;e>=i/2&&null!==v.parent&&v.isLastChild&&t<1;)e-=i,t+=1,v=v.parent;ue.value=t}else ue.value=0;if(!(a.contains(v)||"inside"===p&&(null===(l=a.parent)||void 0===l?void 0:l.key)===v.key)||a.key===b.key&&a.key===v.key)if(r({node:v.rawNode,dropPosition:p,phase:"drag"})){if(a.key===v.key)Pe();else if(X!==v.key)if("inside"===p){if(e.expandOnDragenter){if(function(e){if(W&&(window.clearTimeout(W),W=null),e.isLeaf)return;X=e.key;const n=()=>{if(X!==e.key)return;const{value:n}=ce;if(n&&n.key===e.key&&!I.value.includes(e.key)){const n=I.value.concat(e.key);Ke(n,Ne(n),{node:e.rawNode,action:"expand"})}W=null,X=null};W=e.shallowLoaded?window.setTimeout((()=>{n()}),1e3):window.setTimeout((()=>{me(e).then((()=>{n()}))}),1e3)}(v),!v.shallowLoaded&&X!==v.key)return void Fe()}else if(!v.shallowLoaded)return void Fe()}else Pe();else"inside"!==p&&Pe();se.value=p,de.value=v}else Le();else Le()}G(U,(n=>{var t,o;if(null!==n)if(e.virtualScroll)null===(t=d.value)||void 0===t||t.scrollTo({key:n});else if(e.internalScrollable){const{value:e}=i;if(null===e)return;const t=null===(o=e.contentRef)||void 0===o?void 0:o.querySelector('[data-key="'.concat(oe(n),'"]'));if(!t)return;e.scrollTo({el:t})}})),Y(ie,{loadingKeysRef:ee,highlightKeySetRef:Z,displayedCheckedKeysRef:m,displayedIndeterminateKeysRef:x,mergedSelectedKeysRef:T,mergedExpandedKeysRef:I,mergedThemeRef:a,mergedCheckStrategyRef:k,nodePropsRef:V(e,"nodeProps"),disabledRef:V(e,"disabled"),checkableRef:V(e,"checkable"),selectableRef:V(e,"selectable"),expandOnClickRef:V(e,"expandOnClick"),onLoadRef:V(e,"onLoad"),draggableRef:V(e,"draggable"),blockLineRef:V(e,"blockLine"),indentRef:V(e,"indent"),cascadeRef:V(e,"cascade"),checkOnClickRef:V(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:ce,droppingNodeParentRef:he,draggingNodeRef:le,droppingPositionRef:se,droppingOffsetLevelRef:ue,fNodesRef:z,pendingNodeKeyRef:U,disabledFieldRef:V(e,"disabledField"),internalScrollableRef:V(e,"internalScrollable"),internalCheckboxFocusableRef:V(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:V(e,"renderLabel"),renderPrefixRef:V(e,"renderPrefix"),renderSuffixRef:V(e,"renderSuffix"),renderSwitcherIconRef:V(e,"renderSwitcherIcon"),labelFieldRef:V(e,"labelField"),multipleRef:V(e,"multiple"),handleSwitcherClick:Ee,handleDragEnd:function({event:n,node:t}){Fe(),!e.draggable||e.disabled||fe(t,e.disabledField)||function(n){const{onDragend:t}=e;t&&F(t,n)}({event:n,node:t.rawNode})},handleDragEnter:function({event:n,node:t}){!e.draggable||e.disabled||fe(t,e.disabledField)||(Be({event:n,node:t},!1),function(n){const{onDragenter:t}=e;t&&F(t,n)}({event:n,node:t.rawNode}))},handleDragLeave:function({event:n,node:t}){!e.draggable||e.disabled||fe(t,e.disabledField)||function(n){const{onDragleave:t}=e;t&&F(t,n)}({event:n,node:t.rawNode})},handleDragStart:function({event:n,node:t}){!e.draggable||e.disabled||fe(t,e.disabledField)||(te=n.clientX,le.value=t,function(n){const{onDragstart:t}=e;t&&F(t,n)}({event:n,node:t.rawNode}))},handleDrop:function({event:n,node:t,dropPosition:o}){if(!e.draggable||e.disabled||fe(t,e.disabledField))return;const{value:l}=le,{value:a}=de,{value:r}=se;if(l&&a&&r&&e.allowDrop({node:a.rawNode,dropPosition:r,phase:"drag"})&&l.key!==a.key){if("before"===r){const e=l.getNext({includeDisabled:!0});if(e&&e.key===a.key)return void Le()}if("after"===r){const e=l.getPrev({includeDisabled:!0});if(e&&e.key===a.key)return void Le()}!function(n){const{onDrop:t}=e;t&&F(t,n)}({event:n,node:a.rawNode,dragNode:l.rawNode,dropPosition:o}),Fe()}},handleDragOver:Be,handleSelect:Oe,handleCheck:Te});const Ie={handleKeydown:M,scrollTo:function(e){var n;null===(n=d.value)||void 0===n||n.scrollTo(e)},getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=b.value;return{keys:n,options:Ne(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=b.value;return{keys:n,options:Ne(n)}}},ze=q((()=>{const{common:{cubicBezierEaseInOut:e},self:{fontSize:n,nodeBorderRadius:t,nodeColorHover:o,nodeColorPressed:l,nodeColorActive:r,arrowColor:i,loadingColor:d,nodeTextColor:c,nodeTextColorDisabled:s,dropMarkColor:u}}=a.value;return{"--n-arrow-color":i,"--n-loading-color":d,"--n-bezier":e,"--n-font-size":n,"--n-node-border-radius":t,"--n-node-color-active":r,"--n-node-color-hover":o,"--n-node-color-pressed":l,"--n-node-text-color":c,"--n-node-text-color-disabled":s,"--n-drop-mark-color":u}})),Ue=t?L("tree",void 0,ze,e):void 0;return Object.assign(Object.assign({},Ie),{mergedClsPrefix:n,mergedTheme:a,rtlEnabled:l,fNodes:Re,aip:xe,selfElRef:r,virtualListInstRef:d,scrollbarInstRef:i,handleFocusout:function(n){var t;if(e.virtualScroll||e.internalScrollable){const{value:e}=i;if(null===(t=null==e?void 0:e.containerRef)||void 0===t?void 0:t.contains(n.relatedTarget))return;U.value=null}else{const{value:e}=r;if(null==e?void 0:e.contains(n.relatedTarget))return;U.value=null}},handleDragLeaveTree:function(e){e.target===e.currentTarget&&Le()},handleScroll:function(){Se()},getScrollContainer:function(){var e;return null===(e=d.value)||void 0===e?void 0:e.listElRef},getScrollContent:function(){var e;return null===(e=d.value)||void 0===e?void 0:e.itemsElRef},handleAfterEnter:function(){xe.value=!1,e.virtualScroll&&$(Se)},handleResize:function(){Se()},cssVars:t?void 0:ze,themeClass:null==Ue?void 0:Ue.themeClass,onRender:null==Ue?void 0:Ue.onRender})},render(){var e;const{fNodes:n,internalRenderEmpty:t}=this;if(!n.length&&t)return t();const{mergedClsPrefix:o,blockNode:l,blockLine:a,draggable:r,disabled:i,internalFocusable:d,checkable:c,handleKeydown:s,rtlEnabled:u,handleFocusout:f}=this,h=d&&!i,v=h?"0":void 0,p=["".concat(o,"-tree"),u&&"".concat(o,"-tree--rtl"),c&&"".concat(o,"-tree--checkable"),(a||l)&&"".concat(o,"-tree--block-node"),a&&"".concat(o,"-tree--block-line")],g=e=>"__motion"in e?U(ge,{height:e.height,nodes:e.nodes,clsPrefix:o,mode:e.mode,onAfterEnter:this.handleAfterEnter}):U(pe,{key:e.key,tmNode:e,clsPrefix:o});if(this.virtualScroll){const{mergedTheme:e,internalScrollablePadding:n}=this,t=P(n||"0");return U(T,{ref:"scrollbarInstRef",onDragleave:r?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:p,theme:e.peers.Scrollbar,themeOverrides:e.peerOverrides.Scrollbar,tabindex:v,onKeydown:h?s:void 0,onFocusout:h?f:void 0},{default:()=>{var e;return null===(e=this.onRender)||void 0===e||e.call(this),U(te,{ref:"virtualListInstRef",items:this.fNodes,itemSize:30,ignoreItemResize:this.aip,paddingTop:t.top,paddingBottom:t.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:t.left,paddingRight:t.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:e})=>g(e)})}})}const{internalScrollable:y}=this;return p.push(this.themeClass),null===(e=this.onRender)||void 0===e||e.call(this),y?U(T,{class:p,tabindex:v,onKeydown:h?s:void 0,onFocusout:h?f:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}},{default:()=>U("div",{onDragleave:r?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(g))}):U("div",{class:p,tabindex:v,ref:"selfElRef",style:this.cssVars,onKeydown:h?s:void 0,onFocusout:h?f:void 0,onDragleave:r?this.handleDragLeaveTree:void 0},n.length?n.map(g):E(this.$slots.empty,(()=>[U(O,{class:"".concat(o,"-tree__empty"),theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])))}});const xe=B({},[["render",function(e,n){const t=I;return W(),X(t,Z(e.$attrs,{class:"bt-tabs-second",type:"card",placement:"top"}),{default:J((()=>[Q(e.$slots,"default",{},void 0,!0)])),_:3},16)}],["__scopeId","data-v-7c16fdec"]]);export{me as _,xe as a};
